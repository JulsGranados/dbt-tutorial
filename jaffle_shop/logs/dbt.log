[0m19:02:05.685192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3974BF410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A39749EA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3974BF550>]}


============================== 19:02:05.685192 | 3787908e-05dd-4b49-a0a0-3c7231a9dd88 ==============================
[0m19:02:05.685192 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:02:05.685192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-starter-main\\dbt-starter-main\\jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:02:05.700818 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'jaffle_shop'
[0m19:02:05.700818 [debug] [MainThread]: Command `dbt run` failed at 19:02:05.700818 after 0.20 seconds
[0m19:02:05.700818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3974C7D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A396FA0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3914A4D50>]}
[0m19:02:05.700818 [debug] [MainThread]: Flushing usage events
[0m19:06:22.391303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A0BF450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A0BBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A0BF3D0>]}


============================== 19:06:22.406971 | f491cf04-b82c-4bd8-a1b2-8cb4fc61518b ==============================
[0m19:06:22.406971 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:06:22.406971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-starter-main\\dbt-starter-main\\jaffle_shop\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:06:22.518077 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:06:22.518077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A0D4F10>]}
[0m19:06:22.518077 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:06:22.518077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A0D4790>]}
[0m19:06:22.533705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A0BD750>]}
[0m19:06:22.533705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A0D7A10>]}
[0m19:06:22.549335 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:06:22.549335 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:06:22.549335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A1BE350>]}
[0m19:06:23.124598 [debug] [MainThread]: 1699: static parser successfully parsed dim_customers.sql
[0m19:06:23.140223 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers.sql
[0m19:06:23.140223 [debug] [MainThread]: 1699: static parser successfully parsed stg_orders.sql
[0m19:06:23.171473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A468BD0>]}
[0m19:06:23.171473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A4DA7D0>]}
[0m19:06:23.171473 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:06:23.171473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A45B550>]}
[0m19:06:23.171473 [info ] [MainThread]: 
[0m19:06:23.187100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:06:23.187100 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m19:06:23.187100 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m19:06:23.187100 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m19:06:23.187100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:23.333330 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m19:06:23.334966 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m19:06:23.337155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_dw)
[0m19:06:23.338372 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "dw"
"
[0m19:06:23.343592 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_dw"
[0m19:06:23.344196 [debug] [ThreadPool]: On create_jaffle_shop_dw: BEGIN
[0m19:06:23.345274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:23.381672 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:06:23.382190 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_dw"
[0m19:06:23.383258 [debug] [ThreadPool]: On create_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_dw"} */
create schema if not exists "dw"
[0m19:06:23.393341 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:06:23.394989 [debug] [ThreadPool]: On create_jaffle_shop_dw: COMMIT
[0m19:06:23.396062 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_dw"
[0m19:06:23.396610 [debug] [ThreadPool]: On create_jaffle_shop_dw: COMMIT
[0m19:06:23.402598 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m19:06:23.403150 [debug] [ThreadPool]: On create_jaffle_shop_dw: Close
[0m19:06:23.406361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m19:06:23.412647 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m19:06:23.413203 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m19:06:23.414316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:23.484838 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:06:23.485981 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m19:06:23.486550 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m19:06:23.529930 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m19:06:23.531592 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m19:06:23.534494 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m19:06:23.538912 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:23.540077 [debug] [MainThread]: On master: BEGIN
[0m19:06:23.540609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:06:23.617478 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:06:23.618544 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:23.619596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:06:23.653284 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:06:23.655465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A093FD0>]}
[0m19:06:23.656082 [debug] [MainThread]: On master: ROLLBACK
[0m19:06:23.658958 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:23.659481 [debug] [MainThread]: On master: BEGIN
[0m19:06:23.662725 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:06:23.663789 [debug] [MainThread]: On master: COMMIT
[0m19:06:23.664858 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:23.665389 [debug] [MainThread]: On master: COMMIT
[0m19:06:23.667561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:06:23.669123 [debug] [MainThread]: On master: Close
[0m19:06:23.670286 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:06:23.671887 [info ] [MainThread]: 
[0m19:06:23.686884 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m19:06:23.687404 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m19:06:23.688498 [info ] [Thread-1 (]: 1 of 3 START sql view model dw.stg_customers ................................... [RUN]
[0m19:06:23.689583 [info ] [Thread-2 (]: 2 of 3 START sql view model dw.stg_orders ...................................... [RUN]
[0m19:06:23.690675 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m19:06:23.691724 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m19:06:23.693371 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m19:06:23.693932 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m19:06:23.696128 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m19:06:23.696128 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m19:06:23.696128 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 19:06:23.696128 => 19:06:23.696128
[0m19:06:23.696128 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m19:06:23.696128 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 19:06:23.695058 => 19:06:23.696128
[0m19:06:23.727392 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m19:06:23.727392 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m19:06:23.743017 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m19:06:23.743017 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:06:23.743017 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m19:06:23.743017 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:06:23.743017 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:06:23.754587 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m19:06:23.755517 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:06:23.801446 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:06:23.802524 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:06:23.804131 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "jaffle_shop"."dw"."stg_orders__dbt_tmp"
    
    
  as (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
[0m19:06:23.811923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:06:23.813528 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:06:23.814702 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "jaffle_shop"."dw"."stg_customers__dbt_tmp"
    
    
  as (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
[0m19:06:23.862060 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:06:23.862566 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:06:23.868275 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:06:23.870971 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:06:23.872058 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:06:23.873136 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:06:23.876073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:06:23.876614 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:06:23.887273 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m19:06:23.887273 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m19:06:23.887273 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:06:23.887273 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:06:23.887273 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m19:06:23.887273 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m19:06:23.902857 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:06:23.908205 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:06:23.908205 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:06:23.908741 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m19:06:23.911420 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:06:23.913043 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m19:06:23.914108 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:06:23.915711 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 19:06:23.727392 => 19:06:23.915711
[0m19:06:23.916263 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:06:23.916793 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m19:06:23.918899 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 19:06:23.696128 => 19:06:23.918899
[0m19:06:23.920537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A214450>]}
[0m19:06:23.921679 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m19:06:23.923347 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dw.stg_customers .............................. [[32mCREATE VIEW[0m in 0.23s]
[0m19:06:23.925465 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A18A010>]}
[0m19:06:23.926536 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m19:06:23.928128 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dw.stg_orders ................................. [[32mCREATE VIEW[0m in 0.23s]
[0m19:06:23.930276 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m19:06:23.931870 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m19:06:23.932932 [info ] [Thread-4 (]: 3 of 3 START sql view model dw.dim_customers ................................... [RUN]
[0m19:06:23.934541 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m19:06:23.936160 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m19:06:23.939305 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m19:06:23.940876 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 19:06:23.936681 => 19:06:23.940876
[0m19:06:23.940876 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m19:06:23.940876 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m19:06:23.940876 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:06:23.940876 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m19:06:23.940876 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:06:23.993780 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m19:06:23.994880 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:06:23.995934 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "jaffle_shop"."dw"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m19:06:24.029608 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:06:24.029608 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:06:24.029608 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:06:24.036655 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:06:24.038839 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m19:06:24.039902 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:06:24.040954 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m19:06:24.045802 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m19:06:24.048535 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:06:24.049061 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m19:06:24.051695 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:06:24.053886 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 19:06:23.940876 => 19:06:24.053332
[0m19:06:24.055022 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m19:06:24.056117 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f491cf04-b82c-4bd8-a1b2-8cb4fc61518b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C66A560410>]}
[0m19:06:24.057216 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dw.dim_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m19:06:24.059346 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m19:06:24.062072 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:24.062579 [debug] [MainThread]: On master: BEGIN
[0m19:06:24.062579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:24.102034 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:06:24.103107 [debug] [MainThread]: On master: COMMIT
[0m19:06:24.104182 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:24.105268 [debug] [MainThread]: On master: COMMIT
[0m19:06:24.107485 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:06:24.108576 [debug] [MainThread]: On master: Close
[0m19:06:24.110712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:24.111788 [debug] [MainThread]: Connection 'create_jaffle_shop_dw' was properly closed.
[0m19:06:24.139182 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m19:06:24.139182 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m19:06:24.139182 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m19:06:24.139182 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m19:06:24.139182 [info ] [MainThread]: 
[0m19:06:24.139182 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m19:06:24.139182 [debug] [MainThread]: Command end result
[0m19:06:24.157467 [info ] [MainThread]: 
[0m19:06:24.158634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:24.160222 [info ] [MainThread]: 
[0m19:06:24.161802 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:06:24.163910 [debug] [MainThread]: Command `dbt run` succeeded at 19:06:24.163910 after 1.96 seconds
[0m19:06:24.164963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C667F9B690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C663EBE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C663EC4D50>]}
[0m19:06:24.165488 [debug] [MainThread]: Flushing usage events
[0m22:20:14.670438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCBCF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCBAEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCBCF250>]}


============================== 22:20:14.679537 | 16dbc150-68c7-47df-b6b7-d14f3f89bc90 ==============================
[0m22:20:14.679537 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:20:14.680537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-starter-main\\dbt-starter-main\\jaffle_shop\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:20:14.759537 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m22:20:14.760536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '16dbc150-68c7-47df-b6b7-d14f3f89bc90', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCBCC350>]}
[0m22:20:14.761509 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m22:20:14.763547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '16dbc150-68c7-47df-b6b7-d14f3f89bc90', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCC99790>]}
[0m22:20:14.774478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16dbc150-68c7-47df-b6b7-d14f3f89bc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCCA0710>]}
[0m22:20:14.783468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16dbc150-68c7-47df-b6b7-d14f3f89bc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCCB15D0>]}
[0m22:20:14.796564 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m22:20:14.961530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:20:14.962525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:20:14.967529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16dbc150-68c7-47df-b6b7-d14f3f89bc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DA7D8250>]}
[0m22:20:14.975477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16dbc150-68c7-47df-b6b7-d14f3f89bc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCCB6990>]}
[0m22:20:14.976536 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:20:14.977467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16dbc150-68c7-47df-b6b7-d14f3f89bc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DCCB3C90>]}
[0m22:20:14.979544 [info ] [MainThread]: 
[0m22:20:14.980537 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:20:14.981542 [debug] [MainThread]: Command end result
[0m22:20:14.988470 [debug] [MainThread]: Command `dbt test` succeeded at 22:20:14.988470 after 0.48 seconds
[0m22:20:14.989534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DC6CC350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241DA007890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241D69AE4D0>]}
[0m22:20:14.989534 [debug] [MainThread]: Flushing usage events
[0m22:20:33.786848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F261F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F261F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F261F650>]}


============================== 22:20:33.793849 | 6209ff75-60ba-4919-a96d-5436d99e8059 ==============================
[0m22:20:33.793849 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:20:33.794850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-starter-main\\dbt-starter-main\\jaffle_shop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:20:33.867849 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m22:20:33.869849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6209ff75-60ba-4919-a96d-5436d99e8059', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F2100850>]}
[0m22:20:33.870848 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m22:20:33.871852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6209ff75-60ba-4919-a96d-5436d99e8059', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F26E7CD0>]}
[0m22:20:33.882850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6209ff75-60ba-4919-a96d-5436d99e8059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F2624250>]}
[0m22:20:33.891862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6209ff75-60ba-4919-a96d-5436d99e8059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F2636A10>]}
[0m22:20:33.904862 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m22:20:34.068850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:20:34.069849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:20:34.075415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6209ff75-60ba-4919-a96d-5436d99e8059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F2984550>]}
[0m22:20:34.082415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6209ff75-60ba-4919-a96d-5436d99e8059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F2730FD0>]}
[0m22:20:34.083416 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:20:34.085417 [info ] [MainThread]: 
[0m22:20:34.087418 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:20:34.089416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m22:20:34.097416 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m22:20:34.098416 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m22:20:34.099415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:34.221041 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:20:34.222885 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m22:20:34.224624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_dw)
[0m22:20:34.225762 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "dw"
"
[0m22:20:34.231302 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_dw"
[0m22:20:34.231868 [debug] [ThreadPool]: On create_jaffle_shop_dw: BEGIN
[0m22:20:34.233532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:20:34.267761 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:20:34.268314 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_dw"
[0m22:20:34.269415 [debug] [ThreadPool]: On create_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_dw"} */
create schema if not exists "dw"
[0m22:20:34.277408 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m22:20:34.279109 [debug] [ThreadPool]: On create_jaffle_shop_dw: COMMIT
[0m22:20:34.279718 [debug] [ThreadPool]: Using postgres connection "create_jaffle_shop_dw"
[0m22:20:34.280807 [debug] [ThreadPool]: On create_jaffle_shop_dw: COMMIT
[0m22:20:34.286258 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m22:20:34.287314 [debug] [ThreadPool]: On create_jaffle_shop_dw: Close
[0m22:20:34.290493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m22:20:34.295307 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m22:20:34.296412 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m22:20:34.297026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:34.348683 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:20:34.349749 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m22:20:34.350278 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m22:20:34.383654 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:20:34.385491 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m22:20:34.387847 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m22:20:34.392144 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:34.393724 [debug] [MainThread]: On master: BEGIN
[0m22:20:34.394244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:20:34.428893 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:20:34.429415 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:34.430507 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:20:34.456715 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:20:34.457968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6209ff75-60ba-4919-a96d-5436d99e8059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F26CB5D0>]}
[0m22:20:34.459156 [debug] [MainThread]: On master: ROLLBACK
[0m22:20:34.461456 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:34.462011 [debug] [MainThread]: On master: BEGIN
[0m22:20:34.465827 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:20:34.466406 [debug] [MainThread]: On master: COMMIT
[0m22:20:34.466978 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:34.468037 [debug] [MainThread]: On master: COMMIT
[0m22:20:34.469617 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:20:34.470705 [debug] [MainThread]: On master: Close
[0m22:20:34.472355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:20:34.473952 [info ] [MainThread]: 
[0m22:20:34.489695 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:20:34.490265 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:20:34.491322 [info ] [Thread-1 (]: 1 of 3 START sql view model dw.stg_customers ................................... [RUN]
[0m22:20:34.493460 [info ] [Thread-2 (]: 2 of 3 START sql view model dw.stg_orders ...................................... [RUN]
[0m22:20:34.495626 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m22:20:34.497216 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m22:20:34.498734 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:20:34.499733 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:20:34.502736 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:20:34.504735 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:20:34.512733 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:20:34.503733 => 22:20:34.511734
[0m22:20:34.513735 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:20:34.533763 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:20:34.500733 => 22:20:34.533763
[0m22:20:34.543829 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:20:34.544849 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:20:34.549826 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:20:34.554735 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:20:34.555733 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m22:20:34.555733 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:20:34.560764 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:20:34.561732 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m22:20:34.563731 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:20:34.594196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:20:34.594728 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:20:34.595281 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:20:34.596340 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:20:34.597398 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "jaffle_shop"."dw"."stg_customers__dbt_tmp"
    
    
  as (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
[0m22:20:34.598463 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "jaffle_shop"."dw"."stg_orders__dbt_tmp"
    
    
  as (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
[0m22:20:34.626834 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:20:34.627403 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:20:34.632425 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:20:34.635274 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:20:34.635832 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:20:34.636956 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:20:34.640089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:20:34.640754 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:20:34.651302 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m22:20:34.653309 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m22:20:34.654308 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:20:34.655308 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:20:34.656308 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m22:20:34.657308 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m22:20:34.664651 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:20:34.669020 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:20:34.669583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:20:34.670110 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m22:20:34.673871 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:20:34.676521 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m22:20:34.677579 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:20:34.679935 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:20:34.513735 => 22:20:34.679917
[0m22:20:34.679935 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:20:34.681001 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:20:34.683817 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:20:34.546776 => 22:20:34.683145
[0m22:20:34.685600 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6209ff75-60ba-4919-a96d-5436d99e8059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F2A16910>]}
[0m22:20:34.686727 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:20:34.688335 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dw.stg_orders ................................. [[32mCREATE VIEW[0m in 0.19s]
[0m22:20:34.690993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6209ff75-60ba-4919-a96d-5436d99e8059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F2A32110>]}
[0m22:20:34.692005 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:20:34.694691 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dw.stg_customers .............................. [[32mCREATE VIEW[0m in 0.20s]
[0m22:20:34.697375 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:20:34.698986 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m22:20:34.700064 [info ] [Thread-4 (]: 3 of 3 START sql view model dw.dim_customers ................................... [RUN]
[0m22:20:34.702198 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m22:20:34.703877 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m22:20:34.706535 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m22:20:34.709545 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 22:20:34.704416 => 22:20:34.709545
[0m22:20:34.710545 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m22:20:34.714544 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m22:20:34.716545 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m22:20:34.717545 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m22:20:34.718545 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:20:34.764068 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:20:34.765175 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m22:20:34.765702 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "jaffle_shop"."dw"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:20:34.787887 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:20:34.790693 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m22:20:34.791825 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m22:20:34.794550 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:20:34.796146 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m22:20:34.797275 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m22:20:34.798376 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m22:20:34.803833 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:20:34.806438 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m22:20:34.807437 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m22:20:34.810152 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:20:34.811791 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 22:20:34.711545 => 22:20:34.811258
[0m22:20:34.812323 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m22:20:34.813901 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6209ff75-60ba-4919-a96d-5436d99e8059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245F29D00D0>]}
[0m22:20:34.814972 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dw.dim_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m22:20:34.817106 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m22:20:34.819254 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:34.840695 [debug] [MainThread]: On master: BEGIN
[0m22:20:34.842679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:20:34.889830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:20:34.890886 [debug] [MainThread]: On master: COMMIT
[0m22:20:34.891414 [debug] [MainThread]: Using postgres connection "master"
[0m22:20:34.892504 [debug] [MainThread]: On master: COMMIT
[0m22:20:34.894623 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:20:34.895231 [debug] [MainThread]: On master: Close
[0m22:20:34.896374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:34.896908 [debug] [MainThread]: Connection 'create_jaffle_shop_dw' was properly closed.
[0m22:20:34.897988 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m22:20:34.898538 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:20:34.899613 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:20:34.900147 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m22:20:34.901248 [info ] [MainThread]: 
[0m22:20:34.901858 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m22:20:34.903990 [debug] [MainThread]: Command end result
[0m22:20:34.910829 [info ] [MainThread]: 
[0m22:20:34.911810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:20:34.912828 [info ] [MainThread]: 
[0m22:20:34.913810 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:20:34.915812 [debug] [MainThread]: Command `dbt build` succeeded at 22:20:34.915812 after 1.29 seconds
[0m22:20:34.916830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245EC6BE590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245EC6C4F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245EC6C5010>]}
[0m22:20:34.917811 [debug] [MainThread]: Flushing usage events
[0m22:20:59.751409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A35F450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A33B5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A35F650>]}


============================== 22:20:59.764524 | 49e7c6da-3e05-46c1-85ec-87a8faf5f7e8 ==============================
[0m22:20:59.764524 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:20:59.766443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-starter-main\\dbt-starter-main\\jaffle_shop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:20:59.841409 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m22:20:59.843409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A3751D0>]}
[0m22:20:59.845407 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m22:20:59.847410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A35CB10>]}
[0m22:20:59.859423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018929E43D90>]}
[0m22:20:59.868406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A377890>]}
[0m22:20:59.883406 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m22:21:00.080341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:21:00.080341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:21:00.086302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A6E8110>]}
[0m22:21:00.093319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A467990>]}
[0m22:21:00.094220 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:21:00.096259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A4644D0>]}
[0m22:21:00.098252 [info ] [MainThread]: 
[0m22:21:00.099255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:21:00.101321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m22:21:00.109119 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m22:21:00.110046 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m22:21:00.111048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:00.185195 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:21:00.186801 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m22:21:00.189999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m22:21:00.194780 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m22:21:00.196412 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m22:21:00.197474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:00.237901 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:21:00.238957 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m22:21:00.240010 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m22:21:00.258202 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m22:21:00.259833 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m22:21:00.262573 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m22:21:00.268379 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:00.269442 [debug] [MainThread]: On master: BEGIN
[0m22:21:00.271057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:00.310725 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:21:00.311256 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:00.312342 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:21:00.332723 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m22:21:00.334870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A414110>]}
[0m22:21:00.335438 [debug] [MainThread]: On master: ROLLBACK
[0m22:21:00.338614 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:00.339672 [debug] [MainThread]: On master: BEGIN
[0m22:21:00.343406 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:21:00.344509 [debug] [MainThread]: On master: COMMIT
[0m22:21:00.345569 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:00.346100 [debug] [MainThread]: On master: COMMIT
[0m22:21:00.348313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:21:00.349375 [debug] [MainThread]: On master: Close
[0m22:21:00.350474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:00.352097 [info ] [MainThread]: 
[0m22:21:00.362621 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:21:00.362621 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:21:00.363681 [info ] [Thread-1 (]: 1 of 3 START sql view model dw.stg_customers ................................... [RUN]
[0m22:21:00.364739 [info ] [Thread-2 (]: 2 of 3 START sql view model dw.stg_orders ...................................... [RUN]
[0m22:21:00.366341 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m22:21:00.367384 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m22:21:00.368450 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:21:00.369505 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:21:00.371751 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:21:00.374340 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:21:00.380309 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:21:00.370593 => 22:21:00.379341
[0m22:21:00.380309 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:21:00.373310 => 22:21:00.380309
[0m22:21:00.381310 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:21:00.382309 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:21:00.411309 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:21:00.415308 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:21:00.423309 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:21:00.424313 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m22:21:00.424313 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:21:00.425341 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:21:00.426311 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m22:21:00.429311 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:21:00.481825 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:21:00.482357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:21:00.482889 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:21:00.483991 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:21:00.484521 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "jaffle_shop"."dw"."stg_orders__dbt_tmp"
    
    
  as (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
[0m22:21:00.485576 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "jaffle_shop"."dw"."stg_customers__dbt_tmp"
    
    
  as (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
[0m22:21:00.497983 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:21:00.502925 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:21:00.503451 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:21:00.504492 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:21:00.507132 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:21:00.508178 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:21:00.509759 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:21:00.512438 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:21:00.513004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:21:00.513534 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:21:00.516206 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:21:00.517816 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:21:00.518878 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:21:00.532528 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m22:21:00.532528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:21:00.533530 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:21:00.535530 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m22:21:00.536530 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m22:21:00.537530 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:21:00.538664 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m22:21:00.543324 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:21:00.548151 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m22:21:00.548151 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:21:00.549230 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m22:21:00.551351 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m22:21:00.552390 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m22:21:00.564736 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:21:00.566855 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:21:00.412347 => 22:21:00.566333
[0m22:21:00.567377 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:21:00.568417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:21:00.568948 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A46C450>]}
[0m22:21:00.571102 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:21:00.383308 => 22:21:00.571102
[0m22:21:00.572157 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dw.stg_orders ................................. [[32mCREATE VIEW[0m in 0.20s]
[0m22:21:00.573286 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:21:00.574901 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:21:00.576500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A4AE3D0>]}
[0m22:21:00.579171 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dw.stg_customers .............................. [[32mCREATE VIEW[0m in 0.21s]
[0m22:21:00.580749 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:21:00.582294 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m22:21:00.582828 [info ] [Thread-4 (]: 3 of 3 START sql view model dw.dim_customers ................................... [RUN]
[0m22:21:00.584412 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m22:21:00.585467 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m22:21:00.588644 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m22:21:00.591297 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 22:21:00.585998 => 22:21:00.590778
[0m22:21:00.591823 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m22:21:00.595419 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m22:21:00.597419 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m22:21:00.598420 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m22:21:00.598420 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:21:00.653320 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m22:21:00.653853 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m22:21:00.654904 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "jaffle_shop"."dw"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:21:00.668640 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:21:00.671738 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m22:21:00.672377 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m22:21:00.675613 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:21:00.677273 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m22:21:00.678312 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m22:21:00.679457 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m22:21:00.684757 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m22:21:00.687365 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m22:21:00.688337 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m22:21:00.690985 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:21:00.692575 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 22:21:00.592865 => 22:21:00.692575
[0m22:21:00.693605 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m22:21:00.695285 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e7c6da-3e05-46c1-85ec-87a8faf5f7e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892A7EA7D0>]}
[0m22:21:00.696383 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dw.dim_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m22:21:00.697973 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m22:21:00.700596 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:00.701135 [debug] [MainThread]: On master: BEGIN
[0m22:21:00.702199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:21:00.746446 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:21:00.747533 [debug] [MainThread]: On master: COMMIT
[0m22:21:00.748604 [debug] [MainThread]: Using postgres connection "master"
[0m22:21:00.749675 [debug] [MainThread]: On master: COMMIT
[0m22:21:00.752345 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:21:00.753944 [debug] [MainThread]: On master: Close
[0m22:21:00.756102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:00.757743 [debug] [MainThread]: Connection 'list_jaffle_shop' was properly closed.
[0m22:21:00.758813 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m22:21:00.759903 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:21:00.760954 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:21:00.762009 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m22:21:00.763063 [info ] [MainThread]: 
[0m22:21:00.764126 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m22:21:00.771873 [debug] [MainThread]: Command end result
[0m22:21:00.782873 [info ] [MainThread]: 
[0m22:21:00.783872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:21:00.784872 [info ] [MainThread]: 
[0m22:21:00.786873 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:21:00.789874 [debug] [MainThread]: Command `dbt run` succeeded at 22:21:00.788872 after 1.22 seconds
[0m22:21:00.790873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189240FE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018924104F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018924104D50>]}
[0m22:21:00.792872 [debug] [MainThread]: Flushing usage events
[0m22:40:48.824168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250C7ACE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250C7AA3F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250C7ACE990>]}


============================== 22:40:48.833171 | 4d1980b8-0f7d-4a2f-8893-a569ae0d7e4c ==============================
[0m22:40:48.833171 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:40:48.835172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-starter-main\\dbt-starter-main\\jaffle_shop\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:40:48.836170 [info ] [MainThread]: Setting up your profile.
[0m22:42:05.804494 [error] [MainThread]: Encountered an error:

[0m22:42:05.851459 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\main.py", line 457, in init
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\task\init.py", line 277, in run
    self.create_profile_from_target(adapter, profile_name=profile_name)
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\task\init.py", line 180, in create_profile_from_target
    self.create_profile_from_profile_template(profile_template, profile_name)
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\task\init.py", line 164, in create_profile_from_profile_template
    target = self.generate_target_from_input(prompts, initial_target)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\task\init.py", line 117, in generate_target_from_input
    target = self.generate_target_from_input(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\task\init.py", line 130, in generate_target_from_input
    target[key] = click.prompt(
                  ^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\click\termui.py", line 166, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\click\termui.py", line 149, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m22:42:05.857467 [debug] [MainThread]: Command `dbt init` failed at 22:42:05.856387 after 77.22 seconds
[0m22:42:05.860390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250C7AB23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250C7AD7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250C7AD7CD0>]}
[0m22:42:05.862397 [debug] [MainThread]: Flushing usage events
[0m22:42:21.347681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AA162EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AA1613550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AA162F190>]}


============================== 22:42:21.356770 | 2dd7cd74-937a-4e05-92be-17f8e620863a ==============================
[0m22:42:21.356770 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:42:21.358729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-starter-main\\dbt-starter-main\\jaffle_shop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:42:21.359783 [info ] [MainThread]: Setting up your profile.
[0m22:42:24.262849 [debug] [MainThread]: Command `dbt init` succeeded at 22:42:24.261851 after 3.10 seconds
[0m22:42:24.266838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AA14CC410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AA1612FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AA1612510>]}
[0m22:42:24.271784 [debug] [MainThread]: Flushing usage events
[0m23:41:34.555276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D19F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3CDACCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3CFC6810>]}


============================== 23:41:34.564289 | 274105de-5b44-46b7-9ce5-bda74e570ac5 ==============================
[0m23:41:34.564289 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:41:34.567277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:41:34.642276 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:41:34.644276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D2699D0>]}
[0m23:41:34.646276 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:41:34.648277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D1B93D0>]}
[0m23:41:34.660276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3CB6CC10>]}
[0m23:41:34.670288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D1B3150>]}
[0m23:41:34.706376 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:41:34.886378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:41:34.887379 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models\stg_customers_core.sql
[0m23:41:34.904376 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers_core.sql
[0m23:41:34.924275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D295B50>]}
[0m23:41:34.933276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D5BAB90>]}
[0m23:41:34.934276 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:41:34.936276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D2A2510>]}
[0m23:41:34.937277 [info ] [MainThread]: 
[0m23:41:34.939719 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:34.942725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m23:41:34.951741 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m23:41:34.952725 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m23:41:34.953725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:35.075562 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:41:35.077288 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m23:41:35.080049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m23:41:35.085491 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:41:35.086599 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m23:41:35.087753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:35.144023 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:41:35.145106 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:41:35.146163 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m23:41:35.184170 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:41:35.185833 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m23:41:35.188545 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m23:41:35.193850 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:35.194902 [debug] [MainThread]: On master: BEGIN
[0m23:41:35.196486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:35.249146 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:41:35.250205 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:35.251258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:41:35.283347 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m23:41:35.285545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D182C50>]}
[0m23:41:35.286662 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:35.290083 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:35.290604 [debug] [MainThread]: On master: BEGIN
[0m23:41:35.294345 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:41:35.295446 [debug] [MainThread]: On master: COMMIT
[0m23:41:35.297071 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:35.298132 [debug] [MainThread]: On master: COMMIT
[0m23:41:35.300868 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:41:35.301392 [debug] [MainThread]: On master: Close
[0m23:41:35.302693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:35.304288 [info ] [MainThread]: 
[0m23:41:35.314347 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m23:41:35.315350 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers_core
[0m23:41:35.316347 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m23:41:35.317347 [info ] [Thread-1 (]: 1 of 4 START sql view model dw.stg_customers ................................... [RUN]
[0m23:41:35.320346 [info ] [Thread-2 (]: 2 of 4 START sql view model dw.stg_customers_core .............................. [RUN]
[0m23:41:35.321346 [info ] [Thread-3 (]: 3 of 4 START sql view model dw.stg_orders ...................................... [RUN]
[0m23:41:35.324063 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m23:41:35.325663 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers_core'
[0m23:41:35.327260 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m23:41:35.328843 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m23:41:35.329897 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers_core
[0m23:41:35.330420 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m23:41:35.332572 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m23:41:35.334199 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers_core"
[0m23:41:35.336207 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m23:41:35.343208 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 23:41:35.331516 => 23:41:35.342207
[0m23:41:35.344207 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m23:41:35.382205 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m23:41:35.383208 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (compile): 23:41:35.333693 => 23:41:35.382205
[0m23:41:35.384208 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 23:41:35.335220 => 23:41:35.384208
[0m23:41:35.386206 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers_core
[0m23:41:35.388209 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m23:41:35.392726 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers_core"
[0m23:41:35.393725 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:41:35.398247 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m23:41:35.401250 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m23:41:35.402249 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:41:35.403247 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:41:35.404250 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: BEGIN
[0m23:41:35.405249 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:41:35.407249 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:41:35.408513 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m23:41:35.411372 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:41:35.467109 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:41:35.467642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:41:35.468180 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:41:35.468716 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:41:35.469783 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:41:35.470854 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:41:35.472431 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "jaffle_shop"."dw"."stg_orders__dbt_tmp"
    
    
  as (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
[0m23:41:35.473009 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "jaffle_shop"."dw"."stg_customers__dbt_tmp"
    
    
  as (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
[0m23:41:35.474108 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */

  create view "jaffle_shop"."dw"."stg_customers_core__dbt_tmp"
    
    
  as (
    with customers_core as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders_core as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),


customer_orders_core as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders_core

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers_core

    left join customer_orders_core using (customer_id)

)

select * from final
  );
[0m23:41:35.499320 [debug] [Thread-2 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customers"
LINE 49:         customers.customer_id,
                 ^

[0m23:41:35.500382 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: ROLLBACK
[0m23:41:35.503598 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (execute): 23:41:35.389204 => 23:41:35.503061
[0m23:41:35.504677 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: Close
[0m23:41:35.513348 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:41:35.513870 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:41:35.519712 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:41:35.523500 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:41:35.524560 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:41:35.526164 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:41:35.529915 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:35.530988 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:35.535281 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:41:35.539022 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:41:35.540125 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:41:35.542814 [debug] [Thread-2 (]: Database Error in model stg_customers_core (models\stg_customers_core.sql)
  missing FROM-clause entry for table "customers"
  LINE 49:         customers.customer_id,
                   ^
  compiled Code at target\run\jaffle_shop\models\stg_customers_core.sql
[0m23:41:35.543339 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:41:35.545475 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D623E10>]}
[0m23:41:35.546930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:35.548535 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:35.548001 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model dw.stg_customers_core ..................... [[31mERROR[0m in 0.22s]
[0m23:41:35.563430 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:41:35.565419 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:41:35.566415 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers_core
[0m23:41:35.568418 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:41:35.569416 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:41:35.571417 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:41:35.572418 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:41:35.581891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:41:35.586851 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:41:35.587401 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:41:35.587927 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m23:41:35.590643 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:41:35.592277 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m23:41:35.609434 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:41:35.610443 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 23:41:35.345212 => 23:41:35.610443
[0m23:41:35.611444 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m23:41:35.612518 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:41:35.614229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D5A46D0>]}
[0m23:41:35.615804 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 23:41:35.394727 => 23:41:35.615804
[0m23:41:35.616865 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dw.stg_customers .............................. [[32mCREATE VIEW[0m in 0.29s]
[0m23:41:35.618458 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: Close
[0m23:41:35.619530 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m23:41:35.621168 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D650250>]}
[0m23:41:35.623348 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dw.stg_orders ................................. [[32mCREATE VIEW[0m in 0.29s]
[0m23:41:35.624871 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m23:41:35.625870 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m23:41:35.626865 [info ] [Thread-4 (]: 4 of 4 START sql view model dw.dim_customers ................................... [RUN]
[0m23:41:35.628867 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m23:41:35.629867 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m23:41:35.634068 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m23:41:35.636739 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 23:41:35.631375 => 23:41:35.636739
[0m23:41:35.637833 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m23:41:35.642260 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m23:41:35.645420 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:41:35.646432 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m23:41:35.648433 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:41:35.691646 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:41:35.692677 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:41:35.693320 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "jaffle_shop"."dw"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m23:41:35.714249 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:41:35.716993 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:41:35.718108 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m23:41:35.720760 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:41:35.722853 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:41:35.723902 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:41:35.724426 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:41:35.730726 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:41:35.733287 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:41:35.734286 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m23:41:35.737449 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:41:35.739075 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 23:41:35.638880 => 23:41:35.739075
[0m23:41:35.740121 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m23:41:35.741264 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274105de-5b44-46b7-9ce5-bda74e570ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D5F1910>]}
[0m23:41:35.742329 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dw.dim_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:41:35.743942 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m23:41:35.746041 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:35.747089 [debug] [MainThread]: On master: BEGIN
[0m23:41:35.747618 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:35.783418 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:41:35.784470 [debug] [MainThread]: On master: COMMIT
[0m23:41:35.785032 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:35.786107 [debug] [MainThread]: On master: COMMIT
[0m23:41:35.788741 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:41:35.789815 [debug] [MainThread]: On master: Close
[0m23:41:35.790939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:35.791468 [debug] [MainThread]: Connection 'list_jaffle_shop' was properly closed.
[0m23:41:35.792545 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m23:41:35.793610 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m23:41:35.794132 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers_core' was properly closed.
[0m23:41:35.794656 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m23:41:35.795742 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m23:41:35.796769 [info ] [MainThread]: 
[0m23:41:35.797878 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m23:41:35.798969 [debug] [MainThread]: Command end result
[0m23:41:35.805287 [info ] [MainThread]: 
[0m23:41:35.806286 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:41:35.807287 [info ] [MainThread]: 
[0m23:41:35.808287 [error] [MainThread]: [33mDatabase Error in model stg_customers_core (models\stg_customers_core.sql)[0m
[0m23:41:35.810289 [error] [MainThread]:   missing FROM-clause entry for table "customers"
[0m23:41:35.811287 [error] [MainThread]:   LINE 49:         customers.customer_id,
[0m23:41:35.812286 [error] [MainThread]:                    ^
[0m23:41:35.813286 [error] [MainThread]:   compiled Code at target\run\jaffle_shop\models\stg_customers_core.sql
[0m23:41:35.815285 [info ] [MainThread]: 
[0m23:41:35.816285 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:41:35.817285 [debug] [MainThread]: Command `dbt run` failed at 23:41:35.817285 after 1.46 seconds
[0m23:41:35.817285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D1A4150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D03C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3D285B90>]}
[0m23:41:35.818286 [debug] [MainThread]: Flushing usage events
[0m23:43:03.463812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7406F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7406F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7406F790>]}


============================== 23:43:03.472813 | cd80b3a2-414e-43fb-aa68-7292242a4a96 ==============================
[0m23:43:03.472813 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:43:03.474813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:43:03.550827 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:43:03.552829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7413A990>]}
[0m23:43:03.553816 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:43:03.554817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA74082010>]}
[0m23:43:03.566828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA740846D0>]}
[0m23:43:03.575816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA73F0C8D0>]}
[0m23:43:03.594913 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:43:03.774814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:03.775814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:03.783814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA74085B90>]}
[0m23:43:03.792813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA74176F90>]}
[0m23:43:03.794813 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:43:03.796813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA74150850>]}
[0m23:43:03.797813 [info ] [MainThread]: 
[0m23:43:03.799813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:03.801814 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m23:43:03.810812 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m23:43:03.811814 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m23:43:03.812813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:03.884460 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:43:03.885705 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m23:43:03.889144 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m23:43:03.894167 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:43:03.895807 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m23:43:03.896347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:03.963635 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:03.964175 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:43:03.965777 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m23:43:03.981851 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:43:03.983814 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m23:43:03.986747 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m23:43:03.991681 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:03.993301 [debug] [MainThread]: On master: BEGIN
[0m23:43:03.994386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:04.026492 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:04.027559 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:04.028621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:04.046992 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m23:43:04.049231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7404B490>]}
[0m23:43:04.050278 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:04.053005 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:04.053531 [debug] [MainThread]: On master: BEGIN
[0m23:43:04.057294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:04.058355 [debug] [MainThread]: On master: COMMIT
[0m23:43:04.058892 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:04.059985 [debug] [MainThread]: On master: COMMIT
[0m23:43:04.062637 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:04.063208 [debug] [MainThread]: On master: Close
[0m23:43:04.064825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:04.066483 [info ] [MainThread]: 
[0m23:43:04.077710 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m23:43:04.078239 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers_core
[0m23:43:04.078239 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m23:43:04.079315 [info ] [Thread-1 (]: 1 of 4 START sql view model dw.stg_customers ................................... [RUN]
[0m23:43:04.080376 [info ] [Thread-2 (]: 2 of 4 START sql view model dw.stg_customers_core .............................. [RUN]
[0m23:43:04.081947 [info ] [Thread-3 (]: 3 of 4 START sql view model dw.stg_orders ...................................... [RUN]
[0m23:43:04.083063 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m23:43:04.084177 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers_core'
[0m23:43:04.085292 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m23:43:04.085798 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m23:43:04.086805 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers_core
[0m23:43:04.087824 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m23:43:04.089805 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m23:43:04.091823 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers_core"
[0m23:43:04.093826 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m23:43:04.101806 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 23:43:04.088806 => 23:43:04.101806
[0m23:43:04.102806 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (compile): 23:43:04.090807 => 23:43:04.101806
[0m23:43:04.102806 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m23:43:04.103825 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 23:43:04.092807 => 23:43:04.103825
[0m23:43:04.104908 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers_core
[0m23:43:04.134321 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m23:43:04.135312 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m23:43:04.140201 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers_core"
[0m23:43:04.144285 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m23:43:04.148239 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:04.149202 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:04.150265 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m23:43:04.150265 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:43:04.151236 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m23:43:04.152240 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:43:04.153249 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: BEGIN
[0m23:43:04.154203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:43:04.156239 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:43:04.195348 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:04.195894 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:04.196958 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:04.198614 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:43:04.199688 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "jaffle_shop"."dw"."stg_orders__dbt_tmp"
    
    
  as (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
[0m23:43:04.200768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:04.201290 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */

  create view "jaffle_shop"."dw"."stg_customers_core__dbt_tmp"
    
    
  as (
    with customers_core as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders_core as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),


customer_orders_core as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders_core

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers_core

    left join customer_orders_core using (customer_id)

)

select * from final
  );
[0m23:43:04.202920 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:04.205668 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "jaffle_shop"."dw"."stg_customers__dbt_tmp"
    
    
  as (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
[0m23:43:04.206211 [debug] [Thread-2 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "customers"
LINE 49:         customers.customer_id,
                 ^

[0m23:43:04.207840 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: ROLLBACK
[0m23:43:04.211669 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (execute): 23:43:04.137203 => 23:43:04.211669
[0m23:43:04.212801 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: Close
[0m23:43:04.221538 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:43:04.222382 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:43:04.228263 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:04.232051 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:04.233129 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:43:04.234718 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:43:04.238496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:04.240616 [debug] [Thread-2 (]: Database Error in model stg_customers_core (models\stg_customers_core.sql)
  missing FROM-clause entry for table "customers"
  LINE 49:         customers.customer_id,
                   ^
  compiled Code at target\run\jaffle_shop\models\stg_customers_core.sql
[0m23:43:04.240647 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:04.243886 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:04.244972 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7406D110>]}
[0m23:43:04.248732 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:04.249825 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:43:04.250870 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model dw.stg_customers_core ..................... [[31mERROR[0m in 0.16s]
[0m23:43:04.251848 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:43:04.254210 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers_core
[0m23:43:04.255621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:04.257238 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:04.271055 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:43:04.273054 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:43:04.274057 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:04.275064 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:04.276039 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:43:04.278038 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:43:04.286101 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:04.291248 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:04.291776 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:04.292310 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m23:43:04.295163 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:04.296850 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m23:43:04.302360 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:43:04.304616 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 23:43:04.105454 => 23:43:04.304034
[0m23:43:04.305663 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m23:43:04.305685 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:43:04.306839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7404B190>]}
[0m23:43:04.308491 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 23:43:04.142235 => 23:43:04.308491
[0m23:43:04.309570 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dw.stg_customers .............................. [[32mCREATE VIEW[0m in 0.22s]
[0m23:43:04.311167 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: Close
[0m23:43:04.312234 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m23:43:04.313859 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA743C5550>]}
[0m23:43:04.315477 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dw.stg_orders ................................. [[32mCREATE VIEW[0m in 0.23s]
[0m23:43:04.317074 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m23:43:04.318149 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m23:43:04.319223 [info ] [Thread-4 (]: 4 of 4 START sql view model dw.dim_customers ................................... [RUN]
[0m23:43:04.321401 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m23:43:04.323038 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m23:43:04.326364 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m23:43:04.329231 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 23:43:04.323624 => 23:43:04.328701
[0m23:43:04.329777 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m23:43:04.333457 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m23:43:04.335456 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:43:04.337456 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m23:43:04.338440 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:43:04.390910 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:04.392000 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:43:04.393054 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "jaffle_shop"."dw"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m23:43:04.412940 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:43:04.417569 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:43:04.418224 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m23:43:04.421706 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:04.423383 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:43:04.424540 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:43:04.425672 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:43:04.431274 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:04.433624 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:43:04.434737 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m23:43:04.438064 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:43:04.439769 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 23:43:04.330894 => 23:43:04.439216
[0m23:43:04.440293 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m23:43:04.442032 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd80b3a2-414e-43fb-aa68-7292242a4a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA74597F10>]}
[0m23:43:04.443201 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dw.dim_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:43:04.444891 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m23:43:04.447722 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:04.448231 [debug] [MainThread]: On master: BEGIN
[0m23:43:04.450242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:04.492187 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:04.492735 [debug] [MainThread]: On master: COMMIT
[0m23:43:04.493799 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:04.494893 [debug] [MainThread]: On master: COMMIT
[0m23:43:04.497047 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:04.498147 [debug] [MainThread]: On master: Close
[0m23:43:04.499778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:04.500319 [debug] [MainThread]: Connection 'list_jaffle_shop' was properly closed.
[0m23:43:04.501394 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m23:43:04.501957 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m23:43:04.502498 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers_core' was properly closed.
[0m23:43:04.503562 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m23:43:04.504632 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m23:43:04.505252 [info ] [MainThread]: 
[0m23:43:04.506396 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m23:43:04.509049 [debug] [MainThread]: Command end result
[0m23:43:04.516752 [info ] [MainThread]: 
[0m23:43:04.517735 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:43:04.519736 [info ] [MainThread]: 
[0m23:43:04.520735 [error] [MainThread]: [33mDatabase Error in model stg_customers_core (models\stg_customers_core.sql)[0m
[0m23:43:04.521734 [error] [MainThread]:   missing FROM-clause entry for table "customers"
[0m23:43:04.525756 [error] [MainThread]:   LINE 49:         customers.customer_id,
[0m23:43:04.526736 [error] [MainThread]:                    ^
[0m23:43:04.529738 [error] [MainThread]:   compiled Code at target\run\jaffle_shop\models\stg_customers_core.sql
[0m23:43:04.530760 [info ] [MainThread]: 
[0m23:43:04.531807 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:43:04.533828 [debug] [MainThread]: Command `dbt run` failed at 23:43:04.532767 after 1.27 seconds
[0m23:43:04.533828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA6E014E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA6E015050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA74075AD0>]}
[0m23:43:04.534797 [debug] [MainThread]: Flushing usage events
[0m23:43:58.877660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5487F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5485EA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5487F3D0>]}


============================== 23:43:58.891672 | 8bd39c2b-1926-4009-86c9-c349f309c8b4 ==============================
[0m23:43:58.891672 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:43:58.893667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:43:58.973658 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:43:58.974657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5494BB50>]}
[0m23:43:58.975673 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:43:58.977658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE549487D0>]}
[0m23:43:58.994656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5494BED0>]}
[0m23:43:59.002654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5487D290>]}
[0m23:43:59.016661 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:43:59.182342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:43:59.184238 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\stg_customers_core.sql
[0m23:43:59.197235 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers_core.sql
[0m23:43:59.215237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE54986510>]}
[0m23:43:59.223639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE54CC3150>]}
[0m23:43:59.224699 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:43:59.226267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE54CC3FD0>]}
[0m23:43:59.227891 [info ] [MainThread]: 
[0m23:43:59.228934 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:59.230484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m23:43:59.239490 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m23:43:59.240598 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m23:43:59.241935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:59.312546 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:43:59.314112 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m23:43:59.316509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m23:43:59.321550 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:43:59.322691 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m23:43:59.323252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:59.357205 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.358254 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:43:59.359312 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m23:43:59.375456 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:43:59.376884 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m23:43:59.379333 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m23:43:59.383669 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.384719 [debug] [MainThread]: On master: BEGIN
[0m23:43:59.385281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:59.448699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.450199 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.451787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:59.473362 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m23:43:59.475631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE54950B50>]}
[0m23:43:59.476226 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:59.478954 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.479513 [debug] [MainThread]: On master: BEGIN
[0m23:43:59.483271 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.484326 [debug] [MainThread]: On master: COMMIT
[0m23:43:59.485382 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.485916 [debug] [MainThread]: On master: COMMIT
[0m23:43:59.488064 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:59.489125 [debug] [MainThread]: On master: Close
[0m23:43:59.490740 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:43:59.492427 [info ] [MainThread]: 
[0m23:43:59.501777 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m23:43:59.502314 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers_core
[0m23:43:59.502847 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m23:43:59.503936 [info ] [Thread-1 (]: 1 of 4 START sql view model dw.stg_customers ................................... [RUN]
[0m23:43:59.505012 [info ] [Thread-2 (]: 2 of 4 START sql view model dw.stg_customers_core .............................. [RUN]
[0m23:43:59.506089 [info ] [Thread-3 (]: 3 of 4 START sql view model dw.stg_orders ...................................... [RUN]
[0m23:43:59.507686 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m23:43:59.509282 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers_core'
[0m23:43:59.510372 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m23:43:59.510928 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m23:43:59.511434 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers_core
[0m23:43:59.512442 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m23:43:59.514440 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m23:43:59.516460 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers_core"
[0m23:43:59.517441 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m23:43:59.525441 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (compile): 23:43:59.515440 => 23:43:59.525441
[0m23:43:59.526441 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers_core
[0m23:43:59.527442 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 23:43:59.516460 => 23:43:59.527442
[0m23:43:59.537441 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 23:43:59.513440 => 23:43:59.537441
[0m23:43:59.553442 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers_core"
[0m23:43:59.554478 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m23:43:59.555547 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m23:43:59.560542 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m23:43:59.563497 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m23:43:59.564442 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:43:59.566479 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:59.567498 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: BEGIN
[0m23:43:59.567498 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:59.568481 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m23:43:59.569480 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:43:59.570476 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m23:43:59.571470 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:43:59.573472 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:43:59.620358 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.620893 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:43:59.621967 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */

  create view "jaffle_shop"."dw"."stg_customers_core__dbt_tmp"
    
    
  as (
    with customers_core as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders_core as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),


customer_orders_core as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders_core

    group by 1

),

final as (

    select
        cc.customer_id,
        cc.first_name,
        cc.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.number_of_orders, 0) as number_of_orders
    from customers_core cc

    left join customer_orders_core using (customer_id) co

)

select * from final
  );
[0m23:43:59.625166 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "co"
LINE 57:     left join customer_orders_core using (customer_id) co
                                                                ^

[0m23:43:59.626235 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: ROLLBACK
[0m23:43:59.628925 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (execute): 23:43:59.527442 => 23:43:59.628388
[0m23:43:59.630009 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: Close
[0m23:43:59.633240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.633763 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.634834 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:59.635893 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:59.636950 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "jaffle_shop"."dw"."stg_customers__dbt_tmp"
    
    
  as (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
[0m23:43:59.637498 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "jaffle_shop"."dw"."stg_orders__dbt_tmp"
    
    
  as (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
[0m23:43:59.649792 [debug] [Thread-2 (]: Database Error in model stg_customers_core (models\stg_customers_core.sql)
  syntax error at or near "co"
  LINE 57:     left join customer_orders_core using (customer_id) co
                                                                  ^
  compiled Code at target\run\jaffle_shop\models\stg_customers_core.sql
[0m23:43:59.650866 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE54C02B10>]}
[0m23:43:59.655145 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:43:59.655715 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:43:59.676287 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model dw.stg_customers_core ..................... [[31mERROR[0m in 0.14s]
[0m23:43:59.682288 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:59.685286 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:59.687271 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers_core
[0m23:43:59.688268 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:43:59.689268 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:43:59.693659 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:59.694183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:59.697587 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:59.700344 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:59.700913 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:43:59.702008 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:43:59.705366 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:59.705931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:59.718267 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:43:59.720284 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:43:59.721250 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:59.722258 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:59.723251 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:43:59.724249 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:43:59.732143 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:59.737189 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:43:59.737189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:59.737800 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m23:43:59.740644 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:43:59.741790 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m23:43:59.747702 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:43:59.749317 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 23:43:59.557442 => 23:43:59.749317
[0m23:43:59.750366 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: Close
[0m23:43:59.750947 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:43:59.752010 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE54C70150>]}
[0m23:43:59.754135 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 23:43:59.560542 => 23:43:59.753628
[0m23:43:59.755209 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dw.stg_orders ................................. [[32mCREATE VIEW[0m in 0.24s]
[0m23:43:59.756308 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m23:43:59.757380 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m23:43:59.759011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE54C84650>]}
[0m23:43:59.760639 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dw.stg_customers .............................. [[32mCREATE VIEW[0m in 0.25s]
[0m23:43:59.762762 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m23:43:59.764384 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m23:43:59.765444 [info ] [Thread-4 (]: 4 of 4 START sql view model dw.dim_customers ................................... [RUN]
[0m23:43:59.767047 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m23:43:59.767578 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m23:43:59.770842 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m23:43:59.773535 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 23:43:59.768697 => 23:43:59.773535
[0m23:43:59.774586 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m23:43:59.778441 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m23:43:59.780957 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:43:59.780957 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m23:43:59.781956 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:43:59.835330 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.835865 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:43:59.836968 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "jaffle_shop"."dw"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m23:43:59.853419 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:43:59.856747 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:43:59.857829 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m23:43:59.861084 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:43:59.863307 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:43:59.864358 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:43:59.865412 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:43:59.872439 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:43:59.874694 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:43:59.875781 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m23:43:59.878414 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:43:59.880066 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 23:43:59.775638 => 23:43:59.879511
[0m23:43:59.881118 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m23:43:59.882733 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bd39c2b-1926-4009-86c9-c349f309c8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5485F850>]}
[0m23:43:59.883264 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dw.dim_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m23:43:59.885400 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m23:43:59.887563 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.888616 [debug] [MainThread]: On master: BEGIN
[0m23:43:59.889627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:59.933618 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:43:59.934690 [debug] [MainThread]: On master: COMMIT
[0m23:43:59.935225 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:59.936313 [debug] [MainThread]: On master: COMMIT
[0m23:43:59.939023 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:43:59.939593 [debug] [MainThread]: On master: Close
[0m23:43:59.941774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:59.942880 [debug] [MainThread]: Connection 'list_jaffle_shop' was properly closed.
[0m23:43:59.943954 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m23:43:59.945044 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m23:43:59.945576 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers_core' was properly closed.
[0m23:43:59.946099 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m23:43:59.947194 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m23:43:59.947718 [info ] [MainThread]: 
[0m23:43:59.949300 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m23:43:59.951940 [debug] [MainThread]: Command end result
[0m23:43:59.960464 [info ] [MainThread]: 
[0m23:43:59.962492 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:43:59.963464 [info ] [MainThread]: 
[0m23:43:59.965494 [error] [MainThread]: [33mDatabase Error in model stg_customers_core (models\stg_customers_core.sql)[0m
[0m23:43:59.966465 [error] [MainThread]:   syntax error at or near "co"
[0m23:43:59.968465 [error] [MainThread]:   LINE 57:     left join customer_orders_core using (customer_id) co
[0m23:43:59.969465 [error] [MainThread]:                                                                   ^
[0m23:43:59.971465 [error] [MainThread]:   compiled Code at target\run\jaffle_shop\models\stg_customers_core.sql
[0m23:43:59.973464 [info ] [MainThread]: 
[0m23:43:59.975463 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:43:59.977467 [debug] [MainThread]: Command `dbt run` failed at 23:43:59.977467 after 1.35 seconds
[0m23:43:59.978464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE54885810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE54240AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE4E845050>]}
[0m23:43:59.979464 [debug] [MainThread]: Flushing usage events
[0m23:44:25.250688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1656F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1656C590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1656F690>]}


============================== 23:44:25.259707 | cadf9b48-1321-4564-a05b-8ce91fd808d2 ==============================
[0m23:44:25.259707 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:44:25.260689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:44:25.325790 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:44:25.327783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A16582CD0>]}
[0m23:44:25.328689 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:44:25.329721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A16580910>]}
[0m23:44:25.340689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1640C8D0>]}
[0m23:44:25.348772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1656FA90>]}
[0m23:44:25.361706 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:44:25.512536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:44:25.514539 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\stg_customers_core.sql
[0m23:44:25.529626 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers_core.sql
[0m23:44:25.552559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A16673D50>]}
[0m23:44:25.561537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A16671E50>]}
[0m23:44:25.562578 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:44:25.564568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A166ADBD0>]}
[0m23:44:25.566536 [info ] [MainThread]: 
[0m23:44:25.568567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:44:25.570572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m23:44:25.582632 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m23:44:25.583631 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m23:44:25.584637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:25.664744 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:44:25.666438 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m23:44:25.669368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m23:44:25.674161 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:44:25.675243 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m23:44:25.675794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:25.731105 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:44:25.731643 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:44:25.732750 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m23:44:25.749491 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m23:44:25.751063 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m23:44:25.753184 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m23:44:25.758105 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:25.759187 [debug] [MainThread]: On master: BEGIN
[0m23:44:25.760223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:44:25.791805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:44:25.792870 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:25.793957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:44:25.812797 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m23:44:25.815090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A16589950>]}
[0m23:44:25.815786 [debug] [MainThread]: On master: ROLLBACK
[0m23:44:25.817988 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:25.819072 [debug] [MainThread]: On master: BEGIN
[0m23:44:25.822328 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:44:25.823388 [debug] [MainThread]: On master: COMMIT
[0m23:44:25.824447 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:25.825010 [debug] [MainThread]: On master: COMMIT
[0m23:44:25.827115 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:44:25.827677 [debug] [MainThread]: On master: Close
[0m23:44:25.828794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:44:25.830428 [info ] [MainThread]: 
[0m23:44:25.838880 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m23:44:25.839415 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers_core
[0m23:44:25.839923 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m23:44:25.841005 [info ] [Thread-1 (]: 1 of 4 START sql view model dw.stg_customers ................................... [RUN]
[0m23:44:25.842065 [info ] [Thread-2 (]: 2 of 4 START sql view model dw.stg_customers_core .............................. [RUN]
[0m23:44:25.843163 [info ] [Thread-3 (]: 3 of 4 START sql view model dw.stg_orders ...................................... [RUN]
[0m23:44:25.844261 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m23:44:25.845393 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers_core'
[0m23:44:25.845953 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m23:44:25.847115 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m23:44:25.847671 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers_core
[0m23:44:25.848228 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m23:44:25.849914 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m23:44:25.851482 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers_core"
[0m23:44:25.853467 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m23:44:25.861463 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 23:44:25.848777 => 23:44:25.860463
[0m23:44:25.862464 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m23:44:25.868480 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (compile): 23:44:25.850438 => 23:44:25.868480
[0m23:44:25.884585 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 23:44:25.852481 => 23:44:25.884585
[0m23:44:25.889587 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m23:44:25.890515 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers_core
[0m23:44:25.891503 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m23:44:25.896482 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers_core"
[0m23:44:25.899547 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m23:44:25.901497 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:44:25.902463 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m23:44:25.903463 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:44:25.904465 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:44:25.904465 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:44:25.905464 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m23:44:25.906482 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: BEGIN
[0m23:44:25.909414 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:44:25.910297 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:44:25.964085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:25.964623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:25.965158 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:25.965688 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:44:25.966732 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:44:25.967859 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:44:25.968392 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "jaffle_shop"."dw"."stg_customers__dbt_tmp"
    
    
  as (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
[0m23:44:25.969487 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "jaffle_shop"."dw"."stg_orders__dbt_tmp"
    
    
  as (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
[0m23:44:25.970003 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */

  create view "jaffle_shop"."dw"."stg_customers_core__dbt_tmp"
    
    
  as (
    with customers_core as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders_core as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),


customer_orders_core as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders_core

    group by 1

),

final as (

    select
        cc.customer_id,
        cc.first_name,
        cc.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.number_of_orders, 0) as number_of_orders
    from customers_core as cc

    left join customer_orders_core as co using (customer_id) 

)

select * from final
  );
[0m23:44:25.988189 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:44:25.988722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:44:25.989252 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:44:25.994351 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:44:25.997235 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:44:26.000070 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:44:26.000593 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:44:26.001618 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:44:26.002619 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */
alter table "jaffle_shop"."dw"."stg_customers_core__dbt_tmp" rename to "stg_customers_core"
[0m23:44:26.005906 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:44:26.006442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:44:26.006972 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:44:26.009705 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:44:26.012051 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:44:26.023146 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: COMMIT
[0m23:44:26.024153 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:44:26.025130 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:44:26.026128 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:44:26.029295 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: COMMIT
[0m23:44:26.029820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:44:26.029820 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:44:26.034048 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:44:26.036182 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:44:26.036182 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:44:26.037242 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:44:26.037786 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:44:26.042328 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:44:26.042901 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:44:26.044073 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:44:26.045147 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */
drop view if exists "jaffle_shop"."dw"."stg_customers_core__dbt_backup" cascade
[0m23:44:26.049102 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:44:26.051205 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (execute): 23:44:25.893494 => 23:44:26.051181
[0m23:44:26.051737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:44:26.052261 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: Close
[0m23:44:26.054423 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:44:26.054949 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:44:26.056524 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A16A243D0>]}
[0m23:44:26.057603 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m23:44:26.060249 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:44:26.061304 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dw.stg_customers_core ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:44:26.063584 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m23:44:26.064660 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers_core
[0m23:44:26.069529 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:44:26.071109 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 23:44:25.863464 => 23:44:26.071109
[0m23:44:26.072199 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m23:44:26.072222 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:44:26.073860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1417C150>]}
[0m23:44:26.076059 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 23:44:25.897480 => 23:44:26.075532
[0m23:44:26.077122 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dw.stg_customers .............................. [[32mCREATE VIEW[0m in 0.23s]
[0m23:44:26.078754 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: Close
[0m23:44:26.079819 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m23:44:26.081415 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A16916690>]}
[0m23:44:26.083548 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dw.stg_orders ................................. [[32mCREATE VIEW[0m in 0.24s]
[0m23:44:26.085712 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m23:44:26.086780 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m23:44:26.088380 [info ] [Thread-4 (]: 4 of 4 START sql view model dw.dim_customers ................................... [RUN]
[0m23:44:26.091060 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m23:44:26.092166 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m23:44:26.094986 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m23:44:26.097783 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 23:44:26.092733 => 23:44:26.097260
[0m23:44:26.098393 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m23:44:26.102006 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m23:44:26.104034 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:44:26.105004 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m23:44:26.106024 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:44:26.171752 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:44:26.172289 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:44:26.173893 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "jaffle_shop"."dw"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m23:44:26.193964 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:44:26.196384 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:44:26.197528 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m23:44:26.200798 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:44:26.202452 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:44:26.203612 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:44:26.205177 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:44:26.212165 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:44:26.214382 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:44:26.214937 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m23:44:26.217580 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:44:26.219290 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 23:44:26.099432 => 23:44:26.219290
[0m23:44:26.220411 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m23:44:26.222674 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cadf9b48-1321-4564-a05b-8ce91fd808d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A168C6250>]}
[0m23:44:26.223803 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dw.dim_customers .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m23:44:26.226454 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m23:44:26.228562 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:26.230574 [debug] [MainThread]: On master: BEGIN
[0m23:44:26.230574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:44:26.288652 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:44:26.289710 [debug] [MainThread]: On master: COMMIT
[0m23:44:26.290773 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:26.291821 [debug] [MainThread]: On master: COMMIT
[0m23:44:26.293930 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:44:26.295059 [debug] [MainThread]: On master: Close
[0m23:44:26.296625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:26.297186 [debug] [MainThread]: Connection 'list_jaffle_shop' was properly closed.
[0m23:44:26.298251 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m23:44:26.298784 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m23:44:26.299849 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers_core' was properly closed.
[0m23:44:26.300410 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m23:44:26.301531 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m23:44:26.302098 [info ] [MainThread]: 
[0m23:44:26.303759 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m23:44:26.305415 [debug] [MainThread]: Command end result
[0m23:44:26.312609 [info ] [MainThread]: 
[0m23:44:26.313609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:44:26.314609 [info ] [MainThread]: 
[0m23:44:26.316611 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:44:26.318619 [debug] [MainThread]: Command `dbt run` succeeded at 23:44:26.318619 after 1.25 seconds
[0m23:44:26.319611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1059E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A105A5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A105A4E50>]}
[0m23:44:26.320609 [debug] [MainThread]: Flushing usage events
[0m23:48:01.742527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B68ED10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B2ACCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B66EA90>]}


============================== 23:48:01.751547 | ee5d023d-8820-4c72-91e2-4c46d6a3be82 ==============================
[0m23:48:01.751547 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:48:01.753546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:48:01.828558 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:48:01.830546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B68D290>]}
[0m23:48:01.831548 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:48:01.833548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B68D010>]}
[0m23:48:01.845589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B697F10>]}
[0m23:48:01.855644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B758050>]}
[0m23:48:01.870645 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:48:01.903639 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:48:01.905546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B759310>]}
[0m23:48:02.420545 [debug] [MainThread]: 1699: static parser successfully parsed dim_customers.sql
[0m23:48:02.432545 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers.sql
[0m23:48:02.437547 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers_core.sql
[0m23:48:02.441546 [debug] [MainThread]: 1699: static parser successfully parsed stg_orders.sql
[0m23:48:02.467547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m23:48:02.472546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B6A8DD0>]}
[0m23:48:02.481547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B7B1E50>]}
[0m23:48:02.483546 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:48:02.485546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6BA47910>]}
[0m23:48:02.487546 [info ] [MainThread]: 
[0m23:48:02.488549 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:48:02.490547 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m23:48:02.499563 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m23:48:02.500546 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m23:48:02.501548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:02.572720 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:48:02.574300 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m23:48:02.577544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m23:48:02.582515 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:48:02.584136 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m23:48:02.584658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:02.625589 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:48:02.626715 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:48:02.627765 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m23:48:02.639798 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:48:02.641450 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m23:48:02.644649 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m23:48:02.649968 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:02.651537 [debug] [MainThread]: On master: BEGIN
[0m23:48:02.652570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:48:02.708777 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:48:02.709900 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:02.710994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:48:02.727245 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m23:48:02.729799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6BA0BA10>]}
[0m23:48:02.731016 [debug] [MainThread]: On master: ROLLBACK
[0m23:48:02.733458 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:02.734637 [debug] [MainThread]: On master: BEGIN
[0m23:48:02.738562 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:48:02.739670 [debug] [MainThread]: On master: COMMIT
[0m23:48:02.740727 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:02.741259 [debug] [MainThread]: On master: COMMIT
[0m23:48:02.743984 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:48:02.745047 [debug] [MainThread]: On master: Close
[0m23:48:02.747257 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:48:02.748387 [info ] [MainThread]: 
[0m23:48:02.758125 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m23:48:02.758717 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers_core
[0m23:48:02.758717 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m23:48:02.759796 [info ] [Thread-1 (]: 1 of 4 START sql table model dw.stg_customers .................................. [RUN]
[0m23:48:02.760851 [info ] [Thread-2 (]: 2 of 4 START sql table model dw.stg_customers_core ............................. [RUN]
[0m23:48:02.761933 [info ] [Thread-3 (]: 3 of 4 START sql table model dw.stg_orders ..................................... [RUN]
[0m23:48:02.764063 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m23:48:02.765215 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers_core'
[0m23:48:02.766863 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m23:48:02.767434 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m23:48:02.768442 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers_core
[0m23:48:02.769443 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m23:48:02.771441 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m23:48:02.773460 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers_core"
[0m23:48:02.775462 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m23:48:02.786442 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (compile): 23:48:02.772459 => 23:48:02.785447
[0m23:48:02.786442 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 23:48:02.774461 => 23:48:02.786442
[0m23:48:02.787463 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers_core
[0m23:48:02.788463 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 23:48:02.770441 => 23:48:02.787463
[0m23:48:02.788463 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m23:48:02.819556 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers_core"
[0m23:48:02.819556 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m23:48:02.823552 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m23:48:02.828526 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m23:48:02.833442 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:48:02.834443 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: BEGIN
[0m23:48:02.834443 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:48:02.835442 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:48:02.836474 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:48:02.836474 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m23:48:02.839319 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m23:48:02.839871 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:48:02.840899 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:48:02.885436 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:48:02.886523 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:48:02.887602 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
    

  create  table "jaffle_shop"."dw"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
  
[0m23:48:02.903176 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:48:02.903723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:48:02.904804 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:48:02.905344 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:48:02.906419 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */

  
    

  create  table "jaffle_shop"."dw"."stg_customers_core__dbt_tmp"
  
  
    as
  
  (
    with customers_core as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders_core as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),


customer_orders_core as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders_core

    group by 1

),

final as (

    select
        cc.customer_id,
        cc.first_name,
        cc.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.number_of_orders, 0) as number_of_orders
    from customers_core as cc

    left join customer_orders_core as co using (customer_id) 

)

select * from final
  );
  
[0m23:48:02.907499 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
    

  create  table "jaffle_shop"."dw"."stg_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
  
[0m23:48:02.913036 [debug] [Thread-3 (]: SQL status: SELECT 99 in 0.0 seconds
[0m23:48:02.919450 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:48:02.920537 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:48:02.924909 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:48:02.928179 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:48:02.928711 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m23:48:02.929796 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:48:02.931399 [debug] [Thread-2 (]: SQL status: SELECT 100 in 0.0 seconds
[0m23:48:02.933644 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:48:02.937433 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:48:02.937433 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:48:02.938536 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:48:02.939073 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */
alter table "jaffle_shop"."dw"."stg_customers_core" rename to "stg_customers_core__dbt_backup"
[0m23:48:02.956799 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:48:02.960575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:48:02.961101 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:48:02.961101 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:48:02.964310 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:48:02.965359 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:48:02.968008 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:48:02.969085 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:48:02.971308 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */
alter table "jaffle_shop"."dw"."stg_customers_core__dbt_tmp" rename to "stg_customers_core"
[0m23:48:02.974971 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:48:02.976018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:48:02.976044 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:48:02.980923 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:48:02.983093 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:48:02.984819 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: COMMIT
[0m23:48:02.985967 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m23:48:02.987012 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:48:02.987012 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:48:02.988969 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:48:02.990816 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: COMMIT
[0m23:48:02.995751 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:48:02.997365 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 23:48:02.820570 => 23:48:02.997365
[0m23:48:02.998435 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:48:02.998943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:48:02.998971 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: Close
[0m23:48:03.001717 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:48:03.004493 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:48:03.006107 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6BA2C410>]}
[0m23:48:03.007172 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */
drop view if exists "jaffle_shop"."dw"."stg_customers_core__dbt_backup" cascade
[0m23:48:03.008235 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m23:48:03.010303 [info ] [Thread-3 (]: 3 of 4 OK created sql table model dw.stg_orders ................................ [[32mSELECT 99[0m in 0.24s]
[0m23:48:03.014494 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m23:48:03.020608 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:48:03.022244 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 23:48:02.825531 => 23:48:03.022244
[0m23:48:03.022777 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:48:03.023309 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m23:48:03.025487 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (execute): 23:48:02.789473 => 23:48:03.025487
[0m23:48:03.027116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B7A0350>]}
[0m23:48:03.028191 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: Close
[0m23:48:03.029830 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dw.stg_customers ............................. [[32mSELECT 100[0m in 0.26s]
[0m23:48:03.032063 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B7BF810>]}
[0m23:48:03.033691 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m23:48:03.035335 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dw.stg_customers_core ........................ [[32mSELECT 100[0m in 0.27s]
[0m23:48:03.036951 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m23:48:03.038568 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers_core
[0m23:48:03.040719 [info ] [Thread-4 (]: 4 of 4 START sql table model dw.dim_customers .................................. [RUN]
[0m23:48:03.042908 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m23:48:03.043519 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m23:48:03.046280 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m23:48:03.049677 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 23:48:03.044045 => 23:48:03.049677
[0m23:48:03.050725 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m23:48:03.055752 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m23:48:03.057733 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:48:03.058760 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m23:48:03.059735 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:48:03.106016 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:48:03.106618 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:48:03.107763 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "jaffle_shop"."dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m23:48:03.127057 [debug] [Thread-4 (]: SQL status: SELECT 100 in 0.0 seconds
[0m23:48:03.130370 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:48:03.131764 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m23:48:03.135743 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:48:03.137975 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:48:03.139055 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:48:03.139643 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:48:03.146179 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:48:03.149027 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:48:03.150147 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m23:48:03.152957 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:48:03.154664 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 23:48:03.051733 => 23:48:03.154664
[0m23:48:03.155758 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m23:48:03.157394 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5d023d-8820-4c72-91e2-4c46d6a3be82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6BA765D0>]}
[0m23:48:03.158477 [info ] [Thread-4 (]: 4 of 4 OK created sql table model dw.dim_customers ............................. [[32mSELECT 100[0m in 0.12s]
[0m23:48:03.160097 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m23:48:03.162895 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:03.163948 [debug] [MainThread]: On master: BEGIN
[0m23:48:03.165595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:48:03.210259 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:48:03.211307 [debug] [MainThread]: On master: COMMIT
[0m23:48:03.212408 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:03.213454 [debug] [MainThread]: On master: COMMIT
[0m23:48:03.216127 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:48:03.217175 [debug] [MainThread]: On master: Close
[0m23:48:03.218215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:03.218788 [debug] [MainThread]: Connection 'list_jaffle_shop' was properly closed.
[0m23:48:03.220922 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m23:48:03.221446 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m23:48:03.223051 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers_core' was properly closed.
[0m23:48:03.223575 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m23:48:03.224615 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m23:48:03.226177 [info ] [MainThread]: 
[0m23:48:03.227689 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m23:48:03.230689 [debug] [MainThread]: Command end result
[0m23:48:03.239689 [info ] [MainThread]: 
[0m23:48:03.241688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:03.243689 [info ] [MainThread]: 
[0m23:48:03.244689 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:48:03.246693 [debug] [MainThread]: Command `dbt run` succeeded at 23:48:03.246693 after 1.70 seconds
[0m23:48:03.248689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B696CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6B697A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6542E5D0>]}
[0m23:48:03.249690 [debug] [MainThread]: Flushing usage events
[0m23:50:01.500818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3916DF090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3916BEA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3916DF290>]}


============================== 23:50:01.509878 | 9b379cc8-866e-4957-9128-c9fb1a98ab53 ==============================
[0m23:50:01.509878 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:50:01.511834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:50:01.586872 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:50:01.587821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3916F7B10>]}
[0m23:50:01.589855 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:50:01.590830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3916F6110>]}
[0m23:50:01.603818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C39157C8D0>]}
[0m23:50:01.612817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3916DC710>]}
[0m23:50:01.627594 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:50:01.817560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:50:01.819034 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\stg_customers_core.sql
[0m23:50:01.834145 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers_core.sql
[0m23:50:01.848540 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m23:50:01.853546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C391A8DB50>]}
[0m23:50:01.862648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C391B33190>]}
[0m23:50:01.863548 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:50:01.864546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C391B33FD0>]}
[0m23:50:01.866546 [info ] [MainThread]: 
[0m23:50:01.868546 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:50:01.870546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m23:50:01.879551 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m23:50:01.880552 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m23:50:01.881547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:01.947367 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:50:01.949465 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m23:50:01.952209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m23:50:01.957558 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:50:01.958663 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m23:50:01.959705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:02.009982 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:50:02.011087 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:50:02.012178 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m23:50:02.024647 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:50:02.026899 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m23:50:02.029590 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m23:50:02.034338 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:02.035396 [debug] [MainThread]: On master: BEGIN
[0m23:50:02.036445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:02.083929 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:50:02.084983 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:02.086030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:50:02.101110 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:50:02.102134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C391A8E490>]}
[0m23:50:02.104118 [debug] [MainThread]: On master: ROLLBACK
[0m23:50:02.107809 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:02.108333 [debug] [MainThread]: On master: BEGIN
[0m23:50:02.111995 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:50:02.113052 [debug] [MainThread]: On master: COMMIT
[0m23:50:02.113600 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:02.114652 [debug] [MainThread]: On master: COMMIT
[0m23:50:02.116769 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:50:02.117821 [debug] [MainThread]: On master: Close
[0m23:50:02.119446 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:50:02.121040 [info ] [MainThread]: 
[0m23:50:02.131404 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m23:50:02.131933 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers_core
[0m23:50:02.131933 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m23:50:02.133005 [info ] [Thread-1 (]: 1 of 4 START sql table model dw.stg_customers .................................. [RUN]
[0m23:50:02.134087 [info ] [Thread-2 (]: 2 of 4 START sql view model dw.stg_customers_core .............................. [RUN]
[0m23:50:02.136739 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m23:50:02.138335 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers_core'
[0m23:50:02.135697 [info ] [Thread-3 (]: 3 of 4 START sql table model dw.stg_orders ..................................... [RUN]
[0m23:50:02.139372 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m23:50:02.140380 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers_core
[0m23:50:02.141409 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m23:50:02.143384 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m23:50:02.146382 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers_core"
[0m23:50:02.147382 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m23:50:02.152382 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m23:50:02.157381 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 23:50:02.142381 => 23:50:02.157381
[0m23:50:02.158382 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m23:50:02.159381 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (compile): 23:50:02.144381 => 23:50:02.159381
[0m23:50:02.164932 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 23:50:02.150382 => 23:50:02.164932
[0m23:50:02.191932 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m23:50:02.192930 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers_core
[0m23:50:02.194930 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m23:50:02.215928 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers_core"
[0m23:50:02.218928 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m23:50:02.221928 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:50:02.222928 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:50:02.223928 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m23:50:02.225928 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: BEGIN
[0m23:50:02.226928 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:50:02.227929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:50:02.228928 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:50:02.230930 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m23:50:02.234781 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:50:02.267109 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:50:02.268181 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:50:02.269244 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */

  create view "jaffle_shop"."dw"."stg_customers_core__dbt_tmp"
    
    
  as (
    


with customers_core as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders_core as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),


customer_orders_core as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders_core

    group by 1

),

final as (

    select
        cc.customer_id,
        cc.first_name,
        cc.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.number_of_orders, 0) as number_of_orders
    from customers_core as cc

    left join customer_orders_core as co using (customer_id) 

)

select * from final
  );
[0m23:50:02.280066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:50:02.281139 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:50:02.282201 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
    

  create  table "jaffle_shop"."dw"."stg_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
  
[0m23:50:02.295054 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:50:02.301388 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:50:02.301909 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:50:02.302432 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m23:50:02.302959 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */
alter table "jaffle_shop"."dw"."stg_customers_core" rename to "stg_customers_core__dbt_backup"
[0m23:50:02.338343 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:50:02.342338 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:50:02.344786 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
    

  create  table "jaffle_shop"."dw"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
  
[0m23:50:02.346866 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:50:02.346866 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:50:02.354008 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:50:02.355258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:50:02.357783 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */
alter table "jaffle_shop"."dw"."stg_customers_core__dbt_tmp" rename to "stg_customers_core"
[0m23:50:02.360965 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:50:02.363621 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:50:02.364164 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:50:02.379050 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: COMMIT
[0m23:50:02.380088 [debug] [Thread-3 (]: SQL status: SELECT 99 in 0.0 seconds
[0m23:50:02.380593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:50:02.380925 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:50:02.383584 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:50:02.388586 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:50:02.389585 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: COMMIT
[0m23:50:02.390585 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:50:02.391584 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:50:02.394861 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:50:02.395995 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:50:02.399191 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:50:02.399720 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:50:02.400245 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:50:02.405675 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers_core"
[0m23:50:02.405675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:50:02.407007 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers_core"} */
drop table if exists "jaffle_shop"."dw"."stg_customers_core__dbt_backup" cascade
[0m23:50:02.410189 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:50:02.410189 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:50:02.411793 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop table if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m23:50:02.414393 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:50:02.416022 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:50:02.417085 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:50:02.421830 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:50:02.423939 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers_core (execute): 23:50:02.196931 => 23:50:02.423939
[0m23:50:02.424470 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:50:02.425528 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers_core: Close
[0m23:50:02.426573 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:50:02.429262 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:50:02.430957 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C391B143D0>]}
[0m23:50:02.433143 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 23:50:02.159381 => 23:50:02.433143
[0m23:50:02.434733 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop table if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m23:50:02.435788 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dw.stg_customers_core ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m23:50:02.437369 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m23:50:02.439309 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers_core
[0m23:50:02.441539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C391AD5590>]}
[0m23:50:02.443131 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dw.stg_customers ............................. [[32mSELECT 100[0m in 0.31s]
[0m23:50:02.445814 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m23:50:02.451128 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:50:02.453300 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 23:50:02.216929 => 23:50:02.453300
[0m23:50:02.454377 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: Close
[0m23:50:02.455459 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C391AD5590>]}
[0m23:50:02.456517 [info ] [Thread-3 (]: 3 of 4 OK created sql table model dw.stg_orders ................................ [[32mSELECT 99[0m in 0.31s]
[0m23:50:02.459148 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m23:50:02.461311 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m23:50:02.462931 [info ] [Thread-4 (]: 4 of 4 START sql table model dw.dim_customers .................................. [RUN]
[0m23:50:02.464518 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m23:50:02.465615 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m23:50:02.469137 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m23:50:02.472136 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 23:50:02.466124 => 23:50:02.471135
[0m23:50:02.472136 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m23:50:02.477135 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m23:50:02.479132 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:50:02.481133 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m23:50:02.482133 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:50:02.513982 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:50:02.515117 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:50:02.515651 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "jaffle_shop"."dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m23:50:02.534765 [debug] [Thread-4 (]: SQL status: SELECT 100 in 0.0 seconds
[0m23:50:02.537559 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:50:02.539244 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers" rename to "dim_customers__dbt_backup"
[0m23:50:02.541896 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:50:02.545071 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:50:02.546157 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m23:50:02.550492 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:50:02.552648 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:50:02.553669 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:50:02.554670 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:50:02.561399 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:50:02.564081 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:50:02.565125 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m23:50:02.576756 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:50:02.579021 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 23:50:02.473136 => 23:50:02.578475
[0m23:50:02.579570 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m23:50:02.581293 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b379cc8-866e-4957-9128-c9fb1a98ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C391BB4C90>]}
[0m23:50:02.582402 [info ] [Thread-4 (]: 4 of 4 OK created sql table model dw.dim_customers ............................. [[32mSELECT 100[0m in 0.12s]
[0m23:50:02.584630 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m23:50:02.587333 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:02.587886 [debug] [MainThread]: On master: BEGIN
[0m23:50:02.588974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:50:02.648685 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:50:02.649759 [debug] [MainThread]: On master: COMMIT
[0m23:50:02.651397 [debug] [MainThread]: Using postgres connection "master"
[0m23:50:02.656339 [debug] [MainThread]: On master: COMMIT
[0m23:50:02.659662 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:50:02.660182 [debug] [MainThread]: On master: Close
[0m23:50:02.662333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:02.662840 [debug] [MainThread]: Connection 'list_jaffle_shop' was properly closed.
[0m23:50:02.664524 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m23:50:02.665066 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m23:50:02.666125 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers_core' was properly closed.
[0m23:50:02.667194 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m23:50:02.668247 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m23:50:02.669304 [info ] [MainThread]: 
[0m23:50:02.670903 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m23:50:02.673548 [debug] [MainThread]: Command end result
[0m23:50:02.681664 [info ] [MainThread]: 
[0m23:50:02.682664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:50:02.684666 [info ] [MainThread]: 
[0m23:50:02.685664 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:50:02.687664 [debug] [MainThread]: Command `dbt run` succeeded at 23:50:02.687664 after 1.39 seconds
[0m23:50:02.687664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3911DC750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3916B3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C38B6BE690>]}
[0m23:50:02.689664 [debug] [MainThread]: Flushing usage events
[0m23:52:30.797723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268371F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268371F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268371F390>]}


============================== 23:52:30.805723 | 421865ae-f4a2-4870-ad83-87ab22bb713c ==============================
[0m23:52:30.805723 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:52:30.807724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:52:30.877757 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:52:30.878726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226837EA990>]}
[0m23:52:30.880725 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:52:30.882725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226837EA990>]}
[0m23:52:30.894725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022681691250>]}
[0m23:52:30.904724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226837DFF90>]}
[0m23:52:30.917812 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:52:31.095820 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m23:52:31.097761 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models\bad_practice_customers_core.sql
[0m23:52:31.097761 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models\stg_customers_core.sql
[0m23:52:31.111828 [debug] [MainThread]: 1699: static parser successfully parsed bad_practice_customers_core.sql
[0m23:52:31.125724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m23:52:31.131725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226838125D0>]}
[0m23:52:31.138727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022683B60050>]}
[0m23:52:31.139725 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:52:31.141725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022683AC7690>]}
[0m23:52:31.143725 [info ] [MainThread]: 
[0m23:52:31.145745 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:52:31.147726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m23:52:31.155724 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m23:52:31.157725 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m23:52:31.157725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:31.210552 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m23:52:31.211921 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m23:52:31.215014 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m23:52:31.222780 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:52:31.223860 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m23:52:31.224881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:31.260434 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:52:31.262235 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:52:31.263849 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m23:52:31.279195 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:52:31.281032 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m23:52:31.284307 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m23:52:31.289113 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:31.290191 [debug] [MainThread]: On master: BEGIN
[0m23:52:31.291299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:52:31.324109 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:52:31.325174 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:31.325706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:52:31.341649 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:52:31.343793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268354A990>]}
[0m23:52:31.344888 [debug] [MainThread]: On master: ROLLBACK
[0m23:52:31.347004 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:31.348066 [debug] [MainThread]: On master: BEGIN
[0m23:52:31.351291 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:52:31.352423 [debug] [MainThread]: On master: COMMIT
[0m23:52:31.353490 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:31.354558 [debug] [MainThread]: On master: COMMIT
[0m23:52:31.356685 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:52:31.357747 [debug] [MainThread]: On master: Close
[0m23:52:31.358791 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:52:31.360401 [info ] [MainThread]: 
[0m23:52:31.372405 [debug] [Thread-1 (]: Began running node model.jaffle_shop.bad_practice_customers_core
[0m23:52:31.372936 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m23:52:31.373466 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m23:52:31.374536 [info ] [Thread-1 (]: 1 of 4 START sql view model dw.bad_practice_customers_core ..................... [RUN]
[0m23:52:31.375596 [info ] [Thread-2 (]: 2 of 4 START sql table model dw.stg_customers .................................. [RUN]
[0m23:52:31.376644 [info ] [Thread-3 (]: 3 of 4 START sql table model dw.stg_orders ..................................... [RUN]
[0m23:52:31.378228 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.bad_practice_customers_core'
[0m23:52:31.379242 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m23:52:31.381239 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m23:52:31.382240 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.bad_practice_customers_core
[0m23:52:31.383239 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m23:52:31.384242 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m23:52:31.387258 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.bad_practice_customers_core"
[0m23:52:31.389240 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m23:52:31.391239 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m23:52:31.400240 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.bad_practice_customers_core (compile): 23:52:31.385239 => 23:52:31.400240
[0m23:52:31.401238 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.bad_practice_customers_core
[0m23:52:31.402239 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers (compile): 23:52:31.388239 => 23:52:31.402239
[0m23:52:31.403240 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 23:52:31.390240 => 23:52:31.402239
[0m23:52:31.429257 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.bad_practice_customers_core"
[0m23:52:31.430238 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m23:52:31.432240 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m23:52:31.450257 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m23:52:31.454238 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m23:52:31.455238 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.bad_practice_customers_core"
[0m23:52:31.457240 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: BEGIN
[0m23:52:31.458240 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:52:31.459240 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:52:31.459240 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:52:31.460239 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m23:52:31.462822 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m23:52:31.464090 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:52:31.465700 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:52:31.497052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:52:31.498129 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.bad_practice_customers_core"
[0m23:52:31.499211 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.bad_practice_customers_core"} */

  create view "jaffle_shop"."dw"."bad_practice_customers_core__dbt_tmp"
    
    
  as (
    


with customers_core as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders_core as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),


customer_orders_core as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders_core

    group by 1

),

final as (

    select
        cc.customer_id,
        cc.first_name,
        cc.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.number_of_orders, 0) as number_of_orders
    from customers_core as cc

    left join customer_orders_core as co using (customer_id) 

)

select * from final
  );
[0m23:52:31.502990 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:52:31.504071 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:52:31.505150 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
    

  create  table "jaffle_shop"."dw"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
  
[0m23:52:31.513807 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:52:31.514867 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:52:31.515967 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
    

  create  table "jaffle_shop"."dw"."stg_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
  
[0m23:52:31.530633 [debug] [Thread-3 (]: SQL status: SELECT 99 in 0.0 seconds
[0m23:52:31.536463 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:52:31.536991 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:52:31.536991 [debug] [Thread-2 (]: SQL status: SELECT 100 in 0.0 seconds
[0m23:52:31.538049 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m23:52:31.541284 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.bad_practice_customers_core"
[0m23:52:31.544537 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:52:31.547121 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.bad_practice_customers_core"} */
alter table "jaffle_shop"."dw"."bad_practice_customers_core__dbt_tmp" rename to "bad_practice_customers_core"
[0m23:52:31.547778 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m23:52:31.548312 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:31.552612 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:52:31.553138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:31.553138 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:31.554235 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:52:31.565358 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: COMMIT
[0m23:52:31.568383 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:52:31.570462 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.bad_practice_customers_core"
[0m23:52:31.571954 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:52:31.572489 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:31.573523 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: COMMIT
[0m23:52:31.580611 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:52:31.581143 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:31.582741 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:52:31.585425 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:52:31.586481 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m23:52:31.587550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:52:31.588082 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:52:31.594481 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.bad_practice_customers_core"
[0m23:52:31.595007 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m23:52:31.595538 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m23:52:31.596680 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.bad_practice_customers_core"} */
drop view if exists "jaffle_shop"."dw"."bad_practice_customers_core__dbt_backup" cascade
[0m23:52:31.599383 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m23:52:31.602064 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop table if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m23:52:31.603133 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:52:31.604981 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.bad_practice_customers_core (execute): 23:52:31.403240 => 23:52:31.604981
[0m23:52:31.605516 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:52:31.606051 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: Close
[0m23:52:31.608678 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m23:52:31.610263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022683A9C3D0>]}
[0m23:52:31.611341 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop table if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m23:52:31.612946 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dw.bad_practice_customers_core ................ [[32mCREATE VIEW[0m in 0.23s]
[0m23:52:31.615630 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:52:31.616701 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.bad_practice_customers_core
[0m23:52:31.618837 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 23:52:31.451239 => 23:52:31.618837
[0m23:52:31.620446 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: Close
[0m23:52:31.622053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022683BAAFD0>]}
[0m23:52:31.623119 [info ] [Thread-3 (]: 3 of 4 OK created sql table model dw.stg_orders ................................ [[32mSELECT 99[0m in 0.24s]
[0m23:52:31.625267 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m23:52:31.626876 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:52:31.629507 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers (execute): 23:52:31.434239 => 23:52:31.629001
[0m23:52:31.629507 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: Close
[0m23:52:31.631855 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226836FF6D0>]}
[0m23:52:31.632919 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dw.stg_customers ............................. [[32mSELECT 100[0m in 0.25s]
[0m23:52:31.635036 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m23:52:31.636120 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m23:52:31.637718 [info ] [Thread-4 (]: 4 of 4 START sql table model dw.dim_customers .................................. [RUN]
[0m23:52:31.639859 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m23:52:31.640907 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m23:52:31.644099 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m23:52:31.647809 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 23:52:31.641436 => 23:52:31.647284
[0m23:52:31.648340 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m23:52:31.651857 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m23:52:31.654858 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:52:31.655857 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m23:52:31.655857 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:52:31.707930 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:52:31.709001 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:52:31.710066 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "jaffle_shop"."dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m23:52:31.729971 [debug] [Thread-4 (]: SQL status: SELECT 100 in 0.0 seconds
[0m23:52:31.732742 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:52:31.733268 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers" rename to "dim_customers__dbt_backup"
[0m23:52:31.736006 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:31.739140 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:52:31.739728 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m23:52:31.743455 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:52:31.746092 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:52:31.747144 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:52:31.748193 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m23:52:31.753990 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m23:52:31.756627 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m23:52:31.757675 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m23:52:31.773012 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:52:31.775163 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 23:52:31.648848 => 23:52:31.775163
[0m23:52:31.776811 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m23:52:31.780558 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '421865ae-f4a2-4870-ad83-87ab22bb713c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022683BF3ED0>]}
[0m23:52:31.783759 [info ] [Thread-4 (]: 4 of 4 OK created sql table model dw.dim_customers ............................. [[32mSELECT 100[0m in 0.14s]
[0m23:52:31.785916 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m23:52:31.789092 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:31.790215 [debug] [MainThread]: On master: BEGIN
[0m23:52:31.791264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:52:31.827162 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:52:31.828230 [debug] [MainThread]: On master: COMMIT
[0m23:52:31.829314 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:31.830391 [debug] [MainThread]: On master: COMMIT
[0m23:52:31.833089 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:52:31.834004 [debug] [MainThread]: On master: Close
[0m23:52:31.835275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:31.836467 [debug] [MainThread]: Connection 'list_jaffle_shop' was properly closed.
[0m23:52:31.838185 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m23:52:31.839508 [debug] [MainThread]: Connection 'model.jaffle_shop.bad_practice_customers_core' was properly closed.
[0m23:52:31.841097 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m23:52:31.842163 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m23:52:31.843216 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m23:52:31.843724 [info ] [MainThread]: 
[0m23:52:31.845736 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m23:52:31.847738 [debug] [MainThread]: Command end result
[0m23:52:31.856735 [info ] [MainThread]: 
[0m23:52:31.858736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:52:31.859735 [info ] [MainThread]: 
[0m23:52:31.861774 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:52:31.863737 [debug] [MainThread]: Command `dbt run` succeeded at 23:52:31.863737 after 1.26 seconds
[0m23:52:31.864735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FD4FE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FD504E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FD505110>]}
[0m23:52:31.865735 [debug] [MainThread]: Flushing usage events
[0m23:56:34.517458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BB1F150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BB1F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BB1F450>]}


============================== 23:56:34.526455 | a80779da-01ff-4639-991c-56ec930e9597 ==============================
[0m23:56:34.526455 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:56:34.529434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:56:34.605413 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:56:34.607462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a80779da-01ff-4639-991c-56ec930e9597', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BB35550>]}
[0m23:56:34.608405 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:56:34.610455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a80779da-01ff-4639-991c-56ec930e9597', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BBEA690>]}
[0m23:56:34.622451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a80779da-01ff-4639-991c-56ec930e9597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BB346D0>]}
[0m23:56:34.632455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a80779da-01ff-4639-991c-56ec930e9597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0B6BD710>]}
[0m23:56:34.646405 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:56:34.828803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:56:34.829741 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models\schema.yml
[0m23:56:34.838789 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customers' in the 'models' section of file 'models\schema.yml'
[0m23:56:34.894796 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' (models\schema.yml) depends on a node named 'customers' in package '' which was not found
[0m23:56:34.897801 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d' (models\schema.yml) depends on a node named 'customers' in package '' which was not found
[0m23:56:34.904709 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m23:56:34.910793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a80779da-01ff-4639-991c-56ec930e9597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BF00990>]}
[0m23:56:34.920709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a80779da-01ff-4639-991c-56ec930e9597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BF6CD50>]}
[0m23:56:34.921709 [info ] [MainThread]: Found 4 models, 7 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:56:34.922708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a80779da-01ff-4639-991c-56ec930e9597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BC07610>]}
[0m23:56:34.925741 [info ] [MainThread]: 
[0m23:56:34.927811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:56:34.929707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m23:56:34.938795 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:56:34.940742 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m23:56:34.941727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:35.006938 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.008002 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:56:35.009071 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m23:56:35.021138 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:56:35.022811 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m23:56:35.025586 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m23:56:35.030949 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:35.032000 [debug] [MainThread]: On master: BEGIN
[0m23:56:35.033161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:35.081767 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.082834 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:35.083893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:56:35.098622 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:56:35.100315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a80779da-01ff-4639-991c-56ec930e9597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BB1CC10>]}
[0m23:56:35.101450 [debug] [MainThread]: On master: ROLLBACK
[0m23:56:35.104802 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:35.105334 [debug] [MainThread]: On master: BEGIN
[0m23:56:35.109674 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.110235 [debug] [MainThread]: On master: COMMIT
[0m23:56:35.111333 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:35.111865 [debug] [MainThread]: On master: COMMIT
[0m23:56:35.114026 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:56:35.115120 [debug] [MainThread]: On master: Close
[0m23:56:35.116182 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:56:35.117293 [info ] [MainThread]: 
[0m23:56:35.133297 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m23:56:35.133870 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:56:35.134401 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:35.134932 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:35.135496 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m23:56:35.136549 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m23:56:35.137620 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m23:56:35.139207 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m23:56:35.141217 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad'
[0m23:56:35.142218 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m23:56:35.143218 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5'
[0m23:56:35.145237 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m23:56:35.146238 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m23:56:35.147244 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:56:35.148216 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:35.150218 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:35.156307 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m23:56:35.164509 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:56:35.169510 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:35.173541 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:35.185011 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 23:56:35.170508 => 23:56:35.185011
[0m23:56:35.186053 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 23:56:35.165509 => 23:56:35.185011
[0m23:56:35.187075 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:35.188045 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:35.198610 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:35.200518 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 23:56:35.151284 => 23:56:35.200518
[0m23:56:35.200518 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 23:56:35.157488 => 23:56:35.200518
[0m23:56:35.202604 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:35.205562 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m23:56:35.207548 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:56:35.210517 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m23:56:35.214550 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:56:35.216517 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:35.217518 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:35.218517 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m23:56:35.219519 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m23:56:35.220518 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:56:35.221553 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m23:56:35.222561 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m23:56:35.224665 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:56:35.226327 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m23:56:35.228460 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:56:35.230609 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:56:35.233814 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:56:35.274607 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.276212 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m23:56:35.277829 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "jaffle_shop"."dw"."stg_orders"
where customer_id is null



      
    ) dbt_internal_test
[0m23:56:35.278370 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.280604 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:56:35.281691 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "jaffle_shop"."dw"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m23:56:35.284492 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:35.287306 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 23:56:35.201549 => 23:56:35.286758
[0m23:56:35.287852 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:35.288973 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m23:56:35.292155 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 23:56:35.212517 => 23:56:35.292155
[0m23:56:35.294852 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m23:56:35.295383 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m23:56:35.297545 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m23:56:35.299693 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.298627 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 0.16s]
[0m23:56:35.300237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.302444 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:56:35.301335 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.16s]
[0m23:56:35.304615 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m23:56:35.305680 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m23:56:35.307344 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "jaffle_shop"."dw"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m23:56:35.308412 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:56:35.309484 [debug] [Thread-3 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:56:35.310533 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "jaffle_shop"."dw"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m23:56:35.312199 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m23:56:35.313271 [info ] [Thread-3 (]: 5 of 7 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m23:56:35.316785 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:35.316247 [info ] [Thread-2 (]: 6 of 7 START test unique_stg_customers_customer_id ............................. [RUN]
[0m23:56:35.318434 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m23:56:35.318996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:35.321218 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 23:56:35.189180 => 23:56:35.320647
[0m23:56:35.322349 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m23:56:35.323988 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:56:35.325661 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 23:56:35.209546 => 23:56:35.325661
[0m23:56:35.326836 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m23:56:35.327400 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m23:56:35.332053 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:56:35.334060 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m23:56:35.340308 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m23:56:35.340308 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m23:56:35.343107 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 23:56:35.328459 => 23:56:35.343107
[0m23:56:35.344763 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m23:56:35.345298 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.20s]
[0m23:56:35.346377 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:56:35.346911 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 23:56:35.335214 => 23:56:35.346911
[0m23:56:35.349631 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m23:56:35.348554 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.21s]
[0m23:56:35.352894 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:56:35.353963 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m23:56:35.355571 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m23:56:35.356643 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m23:56:35.361050 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m23:56:35.361557 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:56:35.362566 [info ] [Thread-4 (]: 7 of 7 START test unique_stg_orders_order_id ................................... [RUN]
[0m23:56:35.365566 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m23:56:35.366565 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m23:56:35.367593 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m23:56:35.368566 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:56:35.369565 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m23:56:35.370564 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m23:56:35.373377 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:56:35.377668 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:35.381993 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 23:56:35.374337 => 23:56:35.381464
[0m23:56:35.382552 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m23:56:35.385316 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:35.387993 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:35.389064 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m23:56:35.389660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:56:35.431408 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.431995 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.433094 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m23:56:35.434709 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m23:56:35.435781 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "jaffle_shop"."dw"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "jaffle_shop"."dw"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:56:35.436865 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."dw"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:56:35.442886 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:35.443431 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:35.445596 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 23:56:35.359397 => 23:56:35.445596
[0m23:56:35.447744 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 23:56:35.351216 => 23:56:35.447212
[0m23:56:35.448823 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.449376 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m23:56:35.450436 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m23:56:35.450962 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m23:56:35.453683 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m23:56:35.454220 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m23:56:35.454220 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."dw"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:56:35.456305 [info ] [Thread-2 (]: 6 of 7 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.13s]
[0m23:56:35.457989 [info ] [Thread-3 (]: 5 of 7 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.14s]
[0m23:56:35.460713 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m23:56:35.462342 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m23:56:35.463959 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:56:35.466682 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 23:56:35.383647 => 23:56:35.466682
[0m23:56:35.467731 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m23:56:35.469912 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m23:56:35.471598 [info ] [Thread-4 (]: 7 of 7 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.10s]
[0m23:56:35.474288 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m23:56:35.476446 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:35.477556 [debug] [MainThread]: On master: BEGIN
[0m23:56:35.478607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:56:35.539698 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:56:35.540227 [debug] [MainThread]: On master: COMMIT
[0m23:56:35.541286 [debug] [MainThread]: Using postgres connection "master"
[0m23:56:35.542350 [debug] [MainThread]: On master: COMMIT
[0m23:56:35.544476 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:56:35.545569 [debug] [MainThread]: On master: Close
[0m23:56:35.546728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:35.547777 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m23:56:35.548982 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad' was properly closed.
[0m23:56:35.550595 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m23:56:35.551157 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m23:56:35.552239 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m23:56:35.552788 [info ] [MainThread]: 
[0m23:56:35.554428 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m23:56:35.557805 [debug] [MainThread]: Command end result
[0m23:56:35.567830 [info ] [MainThread]: 
[0m23:56:35.568830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:56:35.570873 [info ] [MainThread]: 
[0m23:56:35.571834 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m23:56:35.573843 [debug] [MainThread]: Command `dbt test` succeeded at 23:56:35.573843 after 1.26 seconds
[0m23:56:35.574847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC08F53D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC05B2E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC0BBC0510>]}
[0m23:56:35.575847 [debug] [MainThread]: Flushing usage events
[0m23:57:39.395210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251990CF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251990AEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251990CF610>]}


============================== 23:57:39.404212 | d21e6f95-c11c-4164-8cfc-19429c5d896d ==============================
[0m23:57:39.404212 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:57:39.406211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:57:39.483211 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:57:39.485236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd21e6f95-c11c-4164-8cfc-19429c5d896d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251990E47D0>]}
[0m23:57:39.486214 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:57:39.488212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd21e6f95-c11c-4164-8cfc-19429c5d896d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251990CC910>]}
[0m23:57:39.500212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd21e6f95-c11c-4164-8cfc-19429c5d896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251990D8210>]}
[0m23:57:39.510210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd21e6f95-c11c-4164-8cfc-19429c5d896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251991941D0>]}
[0m23:57:39.524226 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:57:39.706230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:57:39.708212 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\schema.yml
[0m23:57:39.725210 [debug] [MainThread]: 1699: static parser successfully parsed stg_orders.sql
[0m23:57:39.738211 [debug] [MainThread]: 1699: static parser successfully parsed stg_customers.sql
[0m23:57:39.750307 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customers' in the 'models' section of file 'models\schema.yml'
[0m23:57:39.787214 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' (models\schema.yml) depends on a node named 'customers' in package '' which was not found
[0m23:57:39.789211 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d' (models\schema.yml) depends on a node named 'customers' in package '' which was not found
[0m23:57:39.796211 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m23:57:39.802213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd21e6f95-c11c-4164-8cfc-19429c5d896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002519950B890>]}
[0m23:57:39.806211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd21e6f95-c11c-4164-8cfc-19429c5d896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002519944AC10>]}
[0m23:57:39.807212 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m23:57:39.809211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd21e6f95-c11c-4164-8cfc-19429c5d896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251990E6B90>]}
[0m23:57:39.811212 [info ] [MainThread]: 
[0m23:57:39.813211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:57:39.815212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m23:57:39.828213 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:57:39.829213 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m23:57:39.830212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:39.890015 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:57:39.891113 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m23:57:39.892222 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m23:57:39.905434 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:57:39.906949 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m23:57:39.909640 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m23:57:39.914905 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:39.916515 [debug] [MainThread]: On master: BEGIN
[0m23:57:39.917562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:57:39.967782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:57:39.968893 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:39.969953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:57:39.985112 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m23:57:39.987234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd21e6f95-c11c-4164-8cfc-19429c5d896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251994FAB50>]}
[0m23:57:39.988378 [debug] [MainThread]: On master: ROLLBACK
[0m23:57:39.991083 [debug] [MainThread]: On master: Close
[0m23:57:39.992147 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:57:39.994262 [info ] [MainThread]: 
[0m23:57:40.003724 [debug] [Thread-1 (]: Began running node model.jaffle_shop.bad_practice_customers_core
[0m23:57:40.003724 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m23:57:40.004725 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m23:57:40.005724 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.bad_practice_customers_core'
[0m23:57:40.006725 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m23:57:40.007724 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m23:57:40.008723 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.bad_practice_customers_core
[0m23:57:40.009722 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m23:57:40.010724 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m23:57:40.013724 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.bad_practice_customers_core"
[0m23:57:40.015724 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m23:57:40.018728 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m23:57:40.027723 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.bad_practice_customers_core (compile): 23:57:40.011723 => 23:57:40.027723
[0m23:57:40.028724 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers (compile): 23:57:40.014724 => 23:57:40.027723
[0m23:57:40.029725 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 23:57:40.017729 => 23:57:40.028724
[0m23:57:40.029725 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.bad_practice_customers_core
[0m23:57:40.030722 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m23:57:40.032723 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m23:57:40.033722 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.bad_practice_customers_core (execute): 23:57:40.033722 => 23:57:40.033722
[0m23:57:40.034725 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers (execute): 23:57:40.034725 => 23:57:40.034725
[0m23:57:40.036727 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 23:57:40.035728 => 23:57:40.035728
[0m23:57:40.037724 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.bad_practice_customers_core
[0m23:57:40.038724 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m23:57:40.040727 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m23:57:40.042724 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:57:40.043723 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m23:57:40.044725 [debug] [Thread-2 (]: Began running node model.jaffle_shop.dim_customers
[0m23:57:40.044725 [debug] [Thread-3 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m23:57:40.045758 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m23:57:40.047723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.bad_practice_customers_core, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m23:57:40.048726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.dim_customers)
[0m23:57:40.050724 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m23:57:40.051727 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:57:40.052724 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m23:57:40.053723 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.dim_customers
[0m23:57:40.054723 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m23:57:40.061727 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m23:57:40.068724 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m23:57:40.072724 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m23:57:40.077727 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m23:57:40.082725 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.dim_customers (compile): 23:57:40.069725 => 23:57:40.082725
[0m23:57:40.084727 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.dim_customers
[0m23:57:40.085723 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 23:57:40.055726 => 23:57:40.085723
[0m23:57:40.086723 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 23:57:40.072724 => 23:57:40.085723
[0m23:57:40.086723 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 23:57:40.063724 => 23:57:40.086723
[0m23:57:40.087723 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.dim_customers (execute): 23:57:40.087723 => 23:57:40.087723
[0m23:57:40.088727 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:57:40.089723 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m23:57:40.090723 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m23:57:40.092723 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.dim_customers
[0m23:57:40.093723 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 23:57:40.093723 => 23:57:40.093723
[0m23:57:40.094722 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 23:57:40.094722 => 23:57:40.094722
[0m23:57:40.095724 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 23:57:40.095724 => 23:57:40.095724
[0m23:57:40.096722 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:40.098726 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m23:57:40.099723 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m23:57:40.101723 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m23:57:40.103723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_customers, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m23:57:40.104722 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m23:57:40.107034 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:40.108034 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m23:57:40.112094 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m23:57:40.113048 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m23:57:40.118568 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m23:57:40.119483 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 23:57:40.109034 => 23:57:40.119483
[0m23:57:40.120992 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:40.121564 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 23:57:40.121564 => 23:57:40.121564
[0m23:57:40.122515 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 23:57:40.115523 => 23:57:40.121564
[0m23:57:40.123578 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m23:57:40.123578 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m23:57:40.125211 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 23:57:40.125211 => 23:57:40.125211
[0m23:57:40.127275 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m23:57:40.129378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:40.130474 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m23:57:40.131478 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m23:57:40.132423 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m23:57:40.133470 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad' was properly closed.
[0m23:57:40.134467 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m23:57:40.137422 [debug] [MainThread]: Command end result
[0m23:57:40.156423 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:57:40.157389 [info ] [MainThread]: Building catalog
[0m23:57:40.160388 [debug] [ThreadPool]: Acquiring new postgres connection 'jaffle_shop.information_schema'
[0m23:57:40.169404 [debug] [ThreadPool]: Using postgres connection "jaffle_shop.information_schema"
[0m23:57:40.171404 [debug] [ThreadPool]: On jaffle_shop.information_schema: BEGIN
[0m23:57:40.172404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:40.215378 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:57:40.215916 [debug] [ThreadPool]: Using postgres connection "jaffle_shop.information_schema"
[0m23:57:40.217000 [debug] [ThreadPool]: On jaffle_shop.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "jaffle_shop.information_schema"} */

    
    

    select
        'jaffle_shop' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dw'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:57:40.234774 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m23:57:40.238191 [debug] [ThreadPool]: On jaffle_shop.information_schema: ROLLBACK
[0m23:57:40.240928 [debug] [ThreadPool]: On jaffle_shop.information_schema: Close
[0m23:57:40.250654 [info ] [MainThread]: Catalog written to C:\Users\TZ682VS\OneDrive - EY\Desktop\dbt-juls\dbt-tutorial\jaffle_shop\target\catalog.json
[0m23:57:40.252804 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:57:40.252804 after 1.06 seconds
[0m23:57:40.253909 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:57:40.255007 [debug] [MainThread]: Connection 'jaffle_shop.information_schema' was properly closed.
[0m23:57:40.255534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251930CE6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251991D0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251991D34D0>]}
[0m23:57:40.256682 [debug] [MainThread]: Flushing usage events
[0m23:58:28.473648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284F8DEE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284F8BB510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284F8DF090>]}


============================== 23:58:28.482631 | ce7cd9a5-7365-4fb1-bad6-a6c18cb80002 ==============================
[0m23:58:28.482631 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:58:28.484630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:58:28.559634 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:58:28.560631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce7cd9a5-7365-4fb1-bad6-a6c18cb80002', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284F9A57D0>]}
[0m23:58:28.561630 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:58:28.563630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce7cd9a5-7365-4fb1-bad6-a6c18cb80002', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284F8DC9D0>]}
[0m23:58:28.575630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce7cd9a5-7365-4fb1-bad6-a6c18cb80002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284F8DBD90>]}
[0m23:58:28.585629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce7cd9a5-7365-4fb1-bad6-a6c18cb80002', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284F8F4E90>]}
[0m00:00:49.360756 [error] [MainThread]: Encountered an error:

[0m00:00:49.402124 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\main.py", line 299, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m00:00:49.407285 [debug] [MainThread]: Command `dbt docs serve` failed at 00:00:49.407285 after 141.14 seconds
[0m00:00:49.409286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284F8E7C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284F8E7FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002284F8BA550>]}
[0m00:00:49.411295 [debug] [MainThread]: Flushing usage events
[0m00:00:58.203029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E6EAF010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E6EAF690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E6EAEF50>]}


============================== 00:00:58.212029 | 683c193a-2d3b-4bdd-8b8f-d54ffb24b53d ==============================
[0m00:00:58.212029 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:00:58.214029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:00:58.289142 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m00:00:58.290033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '683c193a-2d3b-4bdd-8b8f-d54ffb24b53d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E6EAFAD0>]}
[0m00:00:58.292029 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m00:00:58.294028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '683c193a-2d3b-4bdd-8b8f-d54ffb24b53d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E6F79E90>]}
[0m00:00:58.306790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '683c193a-2d3b-4bdd-8b8f-d54ffb24b53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E6EC88D0>]}
[0m00:00:58.316045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '683c193a-2d3b-4bdd-8b8f-d54ffb24b53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E6F78250>]}
[0m00:00:58.330043 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:00:58.541028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:00:58.543032 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\schema.yml
[0m00:00:58.558030 [debug] [MainThread]: 1699: static parser successfully parsed stg_orders.sql
[0m00:00:58.608103 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m00:00:58.616028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '683c193a-2d3b-4bdd-8b8f-d54ffb24b53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E6FD68D0>]}
[0m00:00:58.625034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '683c193a-2d3b-4bdd-8b8f-d54ffb24b53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E7341890>]}
[0m00:00:58.626030 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:00:58.628029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '683c193a-2d3b-4bdd-8b8f-d54ffb24b53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E7343FD0>]}
[0m00:00:58.631029 [info ] [MainThread]: 
[0m00:00:58.633029 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:58.636030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m00:00:58.646033 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m00:00:58.648029 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m00:00:58.649029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:58.695994 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:00:58.697055 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m00:00:58.698113 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m00:00:58.709957 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:00:58.711666 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m00:00:58.715038 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m00:00:58.720567 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.721608 [debug] [MainThread]: On master: BEGIN
[0m00:00:58.723186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:58.753154 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:00:58.754200 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.755253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:58.770197 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:00:58.772415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '683c193a-2d3b-4bdd-8b8f-d54ffb24b53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E722F0D0>]}
[0m00:00:58.773469 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:58.776126 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.777161 [debug] [MainThread]: On master: BEGIN
[0m00:00:58.781365 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:00:58.781890 [debug] [MainThread]: On master: COMMIT
[0m00:00:58.782935 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.784019 [debug] [MainThread]: On master: COMMIT
[0m00:00:58.786158 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:00:58.787747 [debug] [MainThread]: On master: Close
[0m00:00:58.789375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:58.790963 [info ] [MainThread]: 
[0m00:00:58.801063 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724
[0m00:00:58.801588 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:00:58.802114 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:00:58.802636 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:00:58.803158 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest  [RUN]
[0m00:00:58.804207 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m00:00:58.805389 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m00:00:58.806435 [info ] [Thread-4 (]: 4 of 5 START test unique_stg_customers_customer_id ............................. [RUN]
[0m00:00:58.807539 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724'
[0m00:00:58.809208 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m00:00:58.810722 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m00:00:58.811724 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada'
[0m00:00:58.812724 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724
[0m00:00:58.813722 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:00:58.815191 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:00:58.815720 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:00:58.822237 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724"
[0m00:00:58.830236 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:00:58.837236 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:00:58.845239 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:00:58.857237 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724 (compile): 00:00:58.816720 => 00:00:58.857237
[0m00:00:58.859235 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724
[0m00:00:58.859235 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 00:00:58.823237 => 00:00:58.859235
[0m00:00:58.860236 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 00:00:58.839241 => 00:00:58.860236
[0m00:00:58.861235 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 00:00:58.832235 => 00:00:58.860236
[0m00:00:58.878235 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724"
[0m00:00:58.879235 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:00:58.881235 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:00:58.883238 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:00:58.888239 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:00:58.891236 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:00:58.892236 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724"
[0m00:00:58.894237 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:00:58.897239 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:00:58.898236 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724: BEGIN
[0m00:00:58.898236 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:00:58.901235 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m00:00:58.902238 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:00:58.902238 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:00:58.904239 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m00:00:58.904239 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:00:58.906239 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m00:00:58.909025 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:00:58.911726 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:00:58.950075 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:58.951705 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:00:58.954044 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."dw"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:00:58.955689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:58.957303 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724"
[0m00:00:58.958375 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "jaffle_shop"."dw"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned','badtest'
)



      
    ) dbt_internal_test
[0m00:00:58.959447 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:58.963180 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 00:00:58.889237 => 00:00:58.962651
[0m00:00:58.963712 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m00:00:58.965293 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:58.967179 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m00:00:58.969821 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724 (execute): 00:00:58.862235 => 00:00:58.969316
[0m00:00:58.972015 [info ] [Thread-4 (]: 4 of 5 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.16s]
[0m00:00:58.973066 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724: ROLLBACK
[0m00:00:58.974128 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:58.974690 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:58.975736 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:00:58.977549 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:00:58.978085 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724: Close
[0m00:00:58.978613 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:00:58.979676 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:00:58.980733 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "jaffle_shop"."dw"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m00:00:58.982363 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest  [[32mPASS[0m in 0.17s]
[0m00:00:58.983952 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "jaffle_shop"."dw"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m00:00:58.986041 [info ] [Thread-4 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m00:00:58.988176 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724
[0m00:00:58.990703 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m00:00:58.991756 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:58.993342 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:00:58.993860 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:58.995430 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 00:00:58.892236 => 00:00:58.995430
[0m00:00:58.999818 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:00:59.001370 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 00:00:58.886236 => 00:00:59.001370
[0m00:00:59.003003 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m00:00:59.005060 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m00:00:59.006740 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 00:00:58.996561 => 00:00:59.006740
[0m00:00:59.008374 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m00:00:59.009427 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:00:59.009427 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m00:00:59.011036 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.20s]
[0m00:00:59.014830 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:00:59.016989 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.21s]
[0m00:00:59.018050 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:00:59.021265 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:00:59.022321 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:00:59.023919 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m00:00:59.025009 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:00:59.074318 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:00:59.075394 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:00:59.076497 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."dw"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:00:59.081217 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:00:59.083416 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 00:00:59.012143 => 00:00:59.082890
[0m00:00:59.083944 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m00:00:59.087717 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m00:00:59.089298 [info ] [Thread-4 (]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.10s]
[0m00:00:59.091462 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:00:59.094089 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:59.095132 [debug] [MainThread]: On master: BEGIN
[0m00:00:59.095670 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:59.131515 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:00:59.132563 [debug] [MainThread]: On master: COMMIT
[0m00:00:59.133607 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:59.134711 [debug] [MainThread]: On master: COMMIT
[0m00:00:59.137426 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:00:59.138504 [debug] [MainThread]: On master: Close
[0m00:00:59.139630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:59.140702 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m00:00:59.141239 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned__badtest.41827c0724' was properly closed.
[0m00:00:59.142308 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
[0m00:00:59.143381 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m00:00:59.143901 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m00:00:59.144960 [info ] [MainThread]: 
[0m00:00:59.146000 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m00:00:59.147559 [debug] [MainThread]: Command end result
[0m00:00:59.155049 [info ] [MainThread]: 
[0m00:00:59.157050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:59.158049 [info ] [MainThread]: 
[0m00:00:59.160074 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:00:59.161080 [debug] [MainThread]: Command `dbt test` succeeded at 00:00:59.161080 after 1.17 seconds
[0m00:00:59.162082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E4AB3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E0E9E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252E601BBD0>]}
[0m00:00:59.163081 [debug] [MainThread]: Flushing usage events
[0m00:01:40.390430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309978F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309978F2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001309978F490>]}


============================== 00:01:40.400433 | f3616f88-816a-4c23-b9ba-505aa84de47e ==============================
[0m00:01:40.400433 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:01:40.402433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:01:40.478528 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m00:01:40.480434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f3616f88-816a-4c23-b9ba-505aa84de47e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130997AA2D0>]}
[0m00:01:40.481432 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m00:01:40.483432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f3616f88-816a-4c23-b9ba-505aa84de47e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130997A9B50>]}
[0m00:01:40.495518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3616f88-816a-4c23-b9ba-505aa84de47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130997A95D0>]}
[0m00:01:40.504529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3616f88-816a-4c23-b9ba-505aa84de47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130988FB190>]}
[0m00:01:40.519432 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:01:40.709649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:01:40.711547 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\schema.yml
[0m00:01:40.727546 [debug] [MainThread]: 1699: static parser successfully parsed stg_orders.sql
[0m00:01:40.775547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m00:01:40.781547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3616f88-816a-4c23-b9ba-505aa84de47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130998AF710>]}
[0m00:01:40.790650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3616f88-816a-4c23-b9ba-505aa84de47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013099C219D0>]}
[0m00:01:40.791749 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:01:40.792695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3616f88-816a-4c23-b9ba-505aa84de47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013099BB7D50>]}
[0m00:01:40.794658 [info ] [MainThread]: 
[0m00:01:40.797657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:01:40.800216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m00:01:40.809161 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m00:01:40.810109 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m00:01:40.811110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:40.887992 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:01:40.889109 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m00:01:40.890805 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m00:01:40.902219 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:01:40.904601 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m00:01:40.907304 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m00:01:40.912751 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:40.913812 [debug] [MainThread]: On master: BEGIN
[0m00:01:40.914873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:01:40.964076 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:01:40.965175 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:40.966267 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:01:40.980586 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:01:40.982870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3616f88-816a-4c23-b9ba-505aa84de47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013099862350>]}
[0m00:01:40.984043 [debug] [MainThread]: On master: ROLLBACK
[0m00:01:40.986784 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:40.987345 [debug] [MainThread]: On master: BEGIN
[0m00:01:40.991267 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:01:40.992356 [debug] [MainThread]: On master: COMMIT
[0m00:01:40.992891 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:40.994537 [debug] [MainThread]: On master: COMMIT
[0m00:01:40.997201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:01:40.998326 [debug] [MainThread]: On master: Close
[0m00:01:40.999390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:01:41.000998 [info ] [MainThread]: 
[0m00:01:41.011749 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045
[0m00:01:41.012287 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:01:41.012287 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:01:41.012812 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:01:41.013338 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_orders_status__placed__shipped__completed  [RUN]
[0m00:01:41.014444 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m00:01:41.015507 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m00:01:41.016603 [info ] [Thread-4 (]: 4 of 5 START test unique_stg_customers_customer_id ............................. [RUN]
[0m00:01:41.018203 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045'
[0m00:01:41.019277 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m00:01:41.020287 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m00:01:41.021287 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada'
[0m00:01:41.022304 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045
[0m00:01:41.023304 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:01:41.024287 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:01:41.025287 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:01:41.031378 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045"
[0m00:01:41.038399 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:01:41.042347 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:01:41.050368 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:01:41.059290 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045 (compile): 00:01:41.026291 => 00:01:41.058289
[0m00:01:41.060290 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045
[0m00:01:41.061323 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 00:01:41.031378 => 00:01:41.060290
[0m00:01:41.061323 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 00:01:41.039291 => 00:01:41.061323
[0m00:01:41.072398 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045"
[0m00:01:41.073327 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:01:41.073327 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 00:01:41.044325 => 00:01:41.073327
[0m00:01:41.074320 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:01:41.079313 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:01:41.080325 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:01:41.084319 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:01:41.084319 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045"
[0m00:01:41.088373 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:01:41.090337 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:01:41.091287 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045: BEGIN
[0m00:01:41.093327 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:01:41.094324 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m00:01:41.096287 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:01:41.097322 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:01:41.098320 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m00:01:41.099286 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:01:41.102322 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m00:01:41.104081 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:01:41.106810 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:01:41.146303 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:01:41.146851 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:01:41.147398 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:01:41.149031 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:01:41.150636 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "jaffle_shop"."dw"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m00:01:41.151749 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."dw"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:01:41.153910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:01:41.155005 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:01:41.156088 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045"
[0m00:01:41.157171 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:01:41.157710 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:01:41.158787 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:01:41.159869 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "jaffle_shop"."dw"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed'
)



      
    ) dbt_internal_test
[0m00:01:41.162570 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 00:01:41.082288 => 00:01:41.162045
[0m00:01:41.163193 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "jaffle_shop"."dw"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m00:01:41.165362 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 00:01:41.086320 => 00:01:41.165362
[0m00:01:41.167445 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m00:01:41.169304 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m00:01:41.169837 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:01:41.171125 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:01:41.172287 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m00:01:41.173896 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045 (execute): 00:01:41.062388 => 00:01:41.173896
[0m00:01:41.174420 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m00:01:41.176020 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 00:01:41.077406 => 00:01:41.176020
[0m00:01:41.213117 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.19s]
[0m00:01:41.216183 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045: ROLLBACK
[0m00:01:41.221687 [info ] [Thread-4 (]: 4 of 5 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.20s]
[0m00:01:41.224138 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m00:01:41.228545 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:01:41.230720 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:01:41.231253 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045: Close
[0m00:01:41.233410 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:01:41.234236 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m00:01:41.235826 [error] [Thread-1 (]: 1 of 5 FAIL 2 accepted_values_stg_orders_status__placed__shipped__completed .... [[31mFAIL 2[0m in 0.22s]
[0m00:01:41.237349 [info ] [Thread-3 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m00:01:41.240184 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.22s]
[0m00:01:41.241840 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045
[0m00:01:41.244036 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m00:01:41.245636 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:01:41.247256 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:01:41.252754 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:01:41.255874 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 00:01:41.249412 => 00:01:41.254873
[0m00:01:41.256873 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:01:41.258874 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:01:41.261873 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:01:41.263300 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m00:01:41.264307 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:01:41.321356 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:01:41.321887 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:01:41.322947 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."dw"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:01:41.328375 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:01:41.330560 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 00:01:41.256873 => 00:01:41.330003
[0m00:01:41.331613 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m00:01:41.334402 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m00:01:41.335978 [info ] [Thread-3 (]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.09s]
[0m00:01:41.338647 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:01:41.340827 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:41.341987 [debug] [MainThread]: On master: BEGIN
[0m00:01:41.343085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:01:41.389252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:01:41.390350 [debug] [MainThread]: On master: COMMIT
[0m00:01:41.391502 [debug] [MainThread]: Using postgres connection "master"
[0m00:01:41.392032 [debug] [MainThread]: On master: COMMIT
[0m00:01:41.395278 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:01:41.395810 [debug] [MainThread]: On master: Close
[0m00:01:41.397455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:41.397982 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m00:01:41.399060 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045' was properly closed.
[0m00:01:41.400137 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
[0m00:01:41.400666 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m00:01:41.401720 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m00:01:41.402277 [info ] [MainThread]: 
[0m00:01:41.403368 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m00:01:41.405533 [debug] [MainThread]: Command end result
[0m00:01:41.413078 [info ] [MainThread]: 
[0m00:01:41.414075 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:01:41.415268 [info ] [MainThread]: 
[0m00:01:41.417275 [error] [MainThread]: [31mFailure in test accepted_values_stg_orders_status__placed__shipped__completed (models\schema.yml)[0m
[0m00:01:41.418275 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m00:01:41.419275 [info ] [MainThread]: 
[0m00:01:41.420274 [info ] [MainThread]:   compiled Code at target\compiled\jaffle_shop\models\schema.yml\accepted_values_stg_orders_status__placed__shipped__completed.sql
[0m00:01:41.422274 [info ] [MainThread]: 
[0m00:01:41.423275 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m00:01:41.424275 [debug] [MainThread]: Command `dbt test` failed at 00:01:41.424275 after 1.24 seconds
[0m00:01:41.425275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013093775110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013093774E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130998D6E10>]}
[0m00:01:41.427278 [debug] [MainThread]: Flushing usage events
[0m00:02:02.181735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192533F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219251DCA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219250F1510>]}


============================== 00:02:02.190652 | 364d1f23-7f2c-4920-8b04-59b7c38924e6 ==============================
[0m00:02:02.190652 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:02:02.192654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:02:02.274553 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m00:02:02.275526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '364d1f23-7f2c-4920-8b04-59b7c38924e6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021925356610>]}
[0m00:02:02.276570 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m00:02:02.278503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '364d1f23-7f2c-4920-8b04-59b7c38924e6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192533F8D0>]}
[0m00:02:02.290558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '364d1f23-7f2c-4920-8b04-59b7c38924e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021925344310>]}
[0m00:02:02.299532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '364d1f23-7f2c-4920-8b04-59b7c38924e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219254043D0>]}
[0m00:02:02.313553 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:02:02.497748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:02:02.498744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:02:02.500702 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m00:02:02.507776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '364d1f23-7f2c-4920-8b04-59b7c38924e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219256F0FD0>]}
[0m00:02:02.511729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '364d1f23-7f2c-4920-8b04-59b7c38924e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219256BF110>]}
[0m00:02:02.512696 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:02:02.514734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '364d1f23-7f2c-4920-8b04-59b7c38924e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219256B3C90>]}
[0m00:02:02.516739 [info ] [MainThread]: 
[0m00:02:02.517695 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:02:02.520739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m00:02:02.529730 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m00:02:02.531735 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m00:02:02.532745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:02.593554 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:02:02.594114 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m00:02:02.595200 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m00:02:02.606848 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:02:02.608532 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m00:02:02.611443 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m00:02:02.617399 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:02.618462 [debug] [MainThread]: On master: BEGIN
[0m00:02:02.618986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:02:02.672575 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:02:02.673655 [debug] [MainThread]: Using postgres connection "master"
[0m00:02:02.674744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:02:02.689524 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:02:02.691143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '364d1f23-7f2c-4920-8b04-59b7c38924e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219249BAD90>]}
[0m00:02:02.692226 [debug] [MainThread]: On master: ROLLBACK
[0m00:02:02.694350 [debug] [MainThread]: On master: Close
[0m00:02:02.695949 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:02:02.697588 [info ] [MainThread]: 
[0m00:02:02.707343 [debug] [Thread-1 (]: Began running node model.jaffle_shop.bad_practice_customers_core
[0m00:02:02.708353 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m00:02:02.708353 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m00:02:02.709352 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.bad_practice_customers_core'
[0m00:02:02.711355 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m00:02:02.712355 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m00:02:02.714355 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.bad_practice_customers_core
[0m00:02:02.715353 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m00:02:02.716353 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m00:02:02.719354 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.bad_practice_customers_core"
[0m00:02:02.721353 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m00:02:02.723371 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m00:02:02.730354 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 00:02:02.722371 => 00:02:02.730354
[0m00:02:02.731354 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m00:02:02.732354 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.bad_practice_customers_core (compile): 00:02:02.717352 => 00:02:02.732354
[0m00:02:02.733354 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 00:02:02.733354 => 00:02:02.733354
[0m00:02:02.734385 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers (compile): 00:02:02.720355 => 00:02:02.733354
[0m00:02:02.734385 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.bad_practice_customers_core
[0m00:02:02.736355 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m00:02:02.737478 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m00:02:02.739440 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.bad_practice_customers_core (execute): 00:02:02.739440 => 00:02:02.739440
[0m00:02:02.741357 [debug] [Thread-4 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045
[0m00:02:02.741357 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:02:02.742387 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers (execute): 00:02:02.742387 => 00:02:02.742387
[0m00:02:02.744387 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.bad_practice_customers_core
[0m00:02:02.745352 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045'
[0m00:02:02.747396 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m00:02:02.749392 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m00:02:02.749392 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:02:02.752359 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045
[0m00:02:02.753397 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:02:02.755395 [debug] [Thread-2 (]: Began running node model.jaffle_shop.dim_customers
[0m00:02:02.756387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.bad_practice_customers_core, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m00:02:02.768435 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045"
[0m00:02:02.776448 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:02:02.779389 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.dim_customers)
[0m00:02:02.780445 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:02:02.785386 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.dim_customers
[0m00:02:02.792386 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:02:02.793354 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045 (compile): 00:02:02.757392 => 00:02:02.793354
[0m00:02:02.797481 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m00:02:02.798477 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 00:02:02.769403 => 00:02:02.798477
[0m00:02:02.801355 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045
[0m00:02:02.803387 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 00:02:02.786387 => 00:02:02.803387
[0m00:02:02.804390 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:02:02.806392 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.dim_customers (compile): 00:02:02.794385 => 00:02:02.806392
[0m00:02:02.807386 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045 (execute): 00:02:02.806392 => 00:02:02.806392
[0m00:02:02.808354 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:02:02.810388 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 00:02:02.810388 => 00:02:02.810388
[0m00:02:02.812428 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.dim_customers
[0m00:02:02.814353 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045
[0m00:02:02.815440 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 00:02:02.815440 => 00:02:02.815440
[0m00:02:02.817353 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:02:02.818394 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.dim_customers (execute): 00:02:02.818394 => 00:02:02.818394
[0m00:02:02.820444 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:02:02.823444 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:02:02.824387 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:02:02.826360 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.dim_customers
[0m00:02:02.827353 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed.b263cf4045, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m00:02:02.830356 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m00:02:02.833354 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:02:02.835354 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:02:02.839352 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:02:02.843355 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:02:02.845354 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 00:02:02.836354 => 00:02:02.845354
[0m00:02:02.846354 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:02:02.848353 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 00:02:02.848353 => 00:02:02.848353
[0m00:02:02.848353 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 00:02:02.840354 => 00:02:02.848353
[0m00:02:02.850353 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:02:02.851352 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:02:02.854353 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 00:02:02.853352 => 00:02:02.853352
[0m00:02:02.855355 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:02:02.857353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:02:02.858352 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m00:02:02.859353 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m00:02:02.861386 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m00:02:02.862355 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m00:02:02.863357 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was properly closed.
[0m00:02:02.865353 [debug] [MainThread]: Command end result
[0m00:02:02.882354 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m00:02:02.883354 [info ] [MainThread]: Building catalog
[0m00:02:02.886355 [debug] [ThreadPool]: Acquiring new postgres connection 'jaffle_shop.information_schema'
[0m00:02:02.891352 [debug] [ThreadPool]: Using postgres connection "jaffle_shop.information_schema"
[0m00:02:02.892352 [debug] [ThreadPool]: On jaffle_shop.information_schema: BEGIN
[0m00:02:02.894353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:02.922980 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:02:02.924153 [debug] [ThreadPool]: Using postgres connection "jaffle_shop.information_schema"
[0m00:02:02.925270 [debug] [ThreadPool]: On jaffle_shop.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "jaffle_shop.information_schema"} */

    
    

    select
        'jaffle_shop' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dw'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m00:02:02.943359 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m00:02:02.946804 [debug] [ThreadPool]: On jaffle_shop.information_schema: ROLLBACK
[0m00:02:02.949637 [debug] [ThreadPool]: On jaffle_shop.information_schema: Close
[0m00:02:02.959363 [info ] [MainThread]: Catalog written to C:\Users\TZ682VS\OneDrive - EY\Desktop\dbt-juls\dbt-tutorial\jaffle_shop\target\catalog.json
[0m00:02:02.961561 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:02:02.961018 after 0.98 seconds
[0m00:02:02.962102 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:02:02.963709 [debug] [MainThread]: Connection 'jaffle_shop.information_schema' was properly closed.
[0m00:02:02.965341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021925328250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191EFA8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219253441D0>]}
[0m00:02:02.966373 [debug] [MainThread]: Flushing usage events
[0m00:02:15.515537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937C0EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937BEEA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937C0F090>]}


============================== 00:02:15.524589 | d80d4cde-790b-4442-aa24-99b0b2b2b4c7 ==============================
[0m00:02:15.524589 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:02:15.526522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:02:15.600589 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m00:02:15.602540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd80d4cde-790b-4442-aa24-99b0b2b2b4c7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937CB2CD0>]}
[0m00:02:15.603634 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m00:02:15.605591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd80d4cde-790b-4442-aa24-99b0b2b2b4c7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937C23350>]}
[0m00:02:15.617588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd80d4cde-790b-4442-aa24-99b0b2b2b4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937C17BD0>]}
[0m00:02:15.626593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd80d4cde-790b-4442-aa24-99b0b2b2b4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937CB3A50>]}
[0m00:03:42.241445 [error] [MainThread]: Encountered an error:

[0m00:03:42.259528 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\cli\main.py", line 299, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\TZ682VS\AppData\Local\miniconda3\envs\dbt-juls\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m00:03:42.263603 [debug] [MainThread]: Command `dbt docs serve` failed at 00:03:42.263603 after 86.96 seconds
[0m00:03:42.265609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937C17D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937C17E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021937C0D150>]}
[0m00:03:42.266609 [debug] [MainThread]: Flushing usage events
[0m00:03:53.439294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D9EEE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D5FCCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D9EF150>]}


============================== 00:03:53.448400 | 4fb86d8d-efa7-44b9-942b-936a002ec39d ==============================
[0m00:03:53.448400 [info ] [MainThread]: Running with dbt=1.5.1
[0m00:03:53.450294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:03:53.529391 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m00:03:53.531294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4fb86d8d-efa7-44b9-942b-936a002ec39d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58DABB650>]}
[0m00:03:53.533295 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m00:03:53.534294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4fb86d8d-efa7-44b9-942b-936a002ec39d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58DABBF90>]}
[0m00:03:53.546393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fb86d8d-efa7-44b9-942b-936a002ec39d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58DAC0F90>]}
[0m00:03:53.556398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fb86d8d-efa7-44b9-942b-936a002ec39d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58DA93E90>]}
[0m00:03:53.571404 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m00:03:53.757293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:03:53.758294 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\schema.yml
[0m00:03:53.774307 [debug] [MainThread]: 1699: static parser successfully parsed stg_orders.sql
[0m00:03:53.821294 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m00:03:53.826294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fb86d8d-efa7-44b9-942b-936a002ec39d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58DAC2190>]}
[0m00:03:53.836294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fb86d8d-efa7-44b9-942b-936a002ec39d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58DE8D8D0>]}
[0m00:03:53.837294 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:03:53.838294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb86d8d-efa7-44b9-942b-936a002ec39d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58DE8FFD0>]}
[0m00:03:53.841295 [info ] [MainThread]: 
[0m00:03:53.842294 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:03:53.845294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m00:03:53.854309 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m00:03:53.855294 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m00:03:53.856309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:53.934890 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:03:53.935959 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m00:03:53.937523 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m00:03:53.949160 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:03:53.950672 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m00:03:53.953311 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m00:03:53.959154 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:53.960212 [debug] [MainThread]: On master: BEGIN
[0m00:03:53.960732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:54.017490 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:03:54.018645 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:54.019737 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:03:54.034035 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m00:03:54.036199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fb86d8d-efa7-44b9-942b-936a002ec39d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58DD61ED0>]}
[0m00:03:54.037276 [debug] [MainThread]: On master: ROLLBACK
[0m00:03:54.039869 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:54.040917 [debug] [MainThread]: On master: BEGIN
[0m00:03:54.045140 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:03:54.045660 [debug] [MainThread]: On master: COMMIT
[0m00:03:54.046699 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:54.047783 [debug] [MainThread]: On master: COMMIT
[0m00:03:54.050435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:03:54.050990 [debug] [MainThread]: On master: Close
[0m00:03:54.052656 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:03:54.054797 [info ] [MainThread]: 
[0m00:03:54.064848 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:03:54.065368 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:03:54.065368 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:03:54.065921 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:03:54.066950 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m00:03:54.068020 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m00:03:54.069585 [info ] [Thread-3 (]: 3 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m00:03:54.070109 [info ] [Thread-4 (]: 4 of 5 START test unique_stg_customers_customer_id ............................. [RUN]
[0m00:03:54.071715 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad'
[0m00:03:54.072742 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m00:03:54.073749 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m00:03:54.074780 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada'
[0m00:03:54.075751 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:03:54.076750 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:03:54.077750 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:03:54.078749 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:03:54.084750 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:03:54.092761 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:03:54.097498 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:03:54.103484 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:03:54.110481 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 00:03:54.079772 => 00:03:54.110481
[0m00:03:54.111481 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:03:54.112481 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 00:03:54.098499 => 00:03:54.111481
[0m00:03:54.122481 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:03:54.124483 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 00:03:54.094751 => 00:03:54.124483
[0m00:03:54.124483 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 00:03:54.085750 => 00:03:54.124483
[0m00:03:54.125483 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:03:54.127482 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:03:54.129484 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:03:54.132483 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:03:54.134483 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:03:54.135483 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:03:54.138483 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:03:54.141483 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
[0m00:03:54.142481 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:03:54.144482 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:03:54.145483 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:03:54.146483 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:03:54.147484 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m00:03:54.148483 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m00:03:54.150484 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m00:03:54.151675 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:03:54.152892 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:03:54.153973 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:03:54.196717 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:03:54.197801 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m00:03:54.198879 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "jaffle_shop"."dw"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m00:03:54.204784 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:03:54.207444 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 00:03:54.137482 => 00:03:54.206918
[0m00:03:54.209044 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m00:03:54.211722 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m00:03:54.213329 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.14s]
[0m00:03:54.214964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:03:54.215500 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:03:54.216036 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:03:54.217645 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m00:03:54.218719 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m00:03:54.219798 [debug] [Thread-3 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:03:54.220899 [debug] [Thread-4 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m00:03:54.222497 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:03:54.223556 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "jaffle_shop"."dw"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m00:03:54.224625 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "jaffle_shop"."dw"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m00:03:54.225160 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."dw"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:03:54.226298 [info ] [Thread-2 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m00:03:54.230684 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m00:03:54.231790 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:03:54.232324 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:03:54.232857 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:03:54.237196 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:03:54.237703 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:03:54.239363 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 00:03:54.134483 => 00:03:54.238832
[0m00:03:54.240936 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 00:03:54.113481 => 00:03:54.240936
[0m00:03:54.244653 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 00:03:54.131480 => 00:03:54.244145
[0m00:03:54.244653 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 00:03:54.233395 => 00:03:54.244653
[0m00:03:54.245664 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m00:03:54.246660 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m00:03:54.247663 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m00:03:54.248663 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:03:54.251751 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m00:03:54.253358 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m00:03:54.256520 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:03:54.256540 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m00:03:54.258141 [info ] [Thread-3 (]: 3 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.18s]
[0m00:03:54.260317 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 0.19s]
[0m00:03:54.264085 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:03:54.263552 [info ] [Thread-4 (]: 4 of 5 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.19s]
[0m00:03:54.265150 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m00:03:54.266806 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m00:03:54.267860 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m00:03:54.269452 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m00:03:54.272678 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:03:54.305935 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:03:54.307060 [debug] [Thread-2 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m00:03:54.308160 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_shop"."dw"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:03:54.313010 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:03:54.315084 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 00:03:54.254414 => 00:03:54.315084
[0m00:03:54.316223 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m00:03:54.318888 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m00:03:54.321019 [info ] [Thread-2 (]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.09s]
[0m00:03:54.323175 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m00:03:54.325832 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:54.326888 [debug] [MainThread]: On master: BEGIN
[0m00:03:54.327408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:03:54.376616 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:03:54.377689 [debug] [MainThread]: On master: COMMIT
[0m00:03:54.378757 [debug] [MainThread]: Using postgres connection "master"
[0m00:03:54.379830 [debug] [MainThread]: On master: COMMIT
[0m00:03:54.382004 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:03:54.383070 [debug] [MainThread]: On master: Close
[0m00:03:54.384742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:54.385316 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m00:03:54.386925 [debug] [MainThread]: Connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad' was properly closed.
[0m00:03:54.388004 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m00:03:54.388536 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m00:03:54.390156 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m00:03:54.391185 [info ] [MainThread]: 
[0m00:03:54.391740 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m00:03:54.393899 [debug] [MainThread]: Command end result
[0m00:03:54.401776 [info ] [MainThread]: 
[0m00:03:54.402776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:03:54.405778 [info ] [MainThread]: 
[0m00:03:54.406777 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:03:54.407778 [debug] [MainThread]: Command `dbt test` succeeded at 00:03:54.407778 after 1.17 seconds
[0m00:03:54.408778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D9F5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58798E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C587995110>]}
[0m00:03:54.410038 [debug] [MainThread]: Flushing usage events
[0m02:45:34.384493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10A1FA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC108DCBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10A1F110>]}


============================== 02:45:34.394560 | 50ddb150-3871-46ce-a0e5-3e7b0e28af9d ==============================
[0m02:45:34.394560 [info ] [MainThread]: Running with dbt=1.5.1
[0m02:45:34.396558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\TZ682VS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\TZ682VS\\OneDrive - EY\\Desktop\\dbt-juls\\dbt-tutorial\\jaffle_shop\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m02:45:34.487528 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:45:34.488493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10A59790>]}
[0m02:45:34.489528 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to ``.Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:45:34.490472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10B0BF90>]}
[0m02:45:34.502531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10A48190>]}
[0m02:45:34.511545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10A3F510>]}
[0m02:45:34.525552 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m02:45:34.743002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:45:34.744001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:45:34.745002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m02:45:34.753001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10B09D10>]}
[0m02:45:34.762002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10B47ED0>]}
[0m02:45:34.763002 [info ] [MainThread]: Found 4 models, 5 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:45:34.764001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10E33D10>]}
[0m02:45:34.766003 [info ] [MainThread]: 
[0m02:45:34.767002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:45:34.769001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop'
[0m02:45:34.777000 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop"
[0m02:45:34.778002 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    select distinct nspname from pg_namespace
  
[0m02:45:34.779002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:34.835703 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m02:45:34.837628 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m02:45:34.840555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_jaffle_shop_dw'
[0m02:45:34.846508 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m02:45:34.847512 [debug] [ThreadPool]: On list_jaffle_shop_dw: BEGIN
[0m02:45:34.849513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:34.899872 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:45:34.900986 [debug] [ThreadPool]: Using postgres connection "list_jaffle_shop_dw"
[0m02:45:34.902107 [debug] [ThreadPool]: On list_jaffle_shop_dw: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_dw"} */
select
      'jaffle_shop' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dw'
    union all
    select
      'jaffle_shop' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dw'
  
[0m02:45:34.918599 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m02:45:34.920112 [debug] [ThreadPool]: On list_jaffle_shop_dw: ROLLBACK
[0m02:45:34.923163 [debug] [ThreadPool]: On list_jaffle_shop_dw: Close
[0m02:45:34.928289 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:34.928843 [debug] [MainThread]: On master: BEGIN
[0m02:45:34.930002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:45:34.969859 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:45:34.971003 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:34.972047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:45:34.989168 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m02:45:34.991545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC100BACD0>]}
[0m02:45:34.992095 [debug] [MainThread]: On master: ROLLBACK
[0m02:45:34.994823 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:34.995347 [debug] [MainThread]: On master: BEGIN
[0m02:45:34.998475 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:45:34.999518 [debug] [MainThread]: On master: COMMIT
[0m02:45:35.000067 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:35.001143 [debug] [MainThread]: On master: COMMIT
[0m02:45:35.002705 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.003785 [debug] [MainThread]: On master: Close
[0m02:45:35.004863 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:45:35.006462 [info ] [MainThread]: 
[0m02:45:35.021331 [debug] [Thread-1 (]: Began running node model.jaffle_shop.bad_practice_customers_core
[0m02:45:35.021863 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m02:45:35.022387 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m02:45:35.022943 [info ] [Thread-1 (]: 1 of 4 START sql view model dw.bad_practice_customers_core ..................... [RUN]
[0m02:45:35.024050 [info ] [Thread-2 (]: 2 of 4 START sql table model dw.stg_customers .................................. [RUN]
[0m02:45:35.025118 [info ] [Thread-3 (]: 3 of 4 START sql table model dw.stg_orders ..................................... [RUN]
[0m02:45:35.026128 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.jaffle_shop.bad_practice_customers_core'
[0m02:45:35.027128 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_customers'
[0m02:45:35.029125 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.jaffle_shop.stg_orders'
[0m02:45:35.030128 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.bad_practice_customers_core
[0m02:45:35.030128 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m02:45:35.031128 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m02:45:35.035126 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.bad_practice_customers_core"
[0m02:45:35.037128 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m02:45:35.039126 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m02:45:35.049128 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (compile): 02:45:35.038125 => 02:45:35.048127
[0m02:45:35.049128 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers (compile): 02:45:35.036127 => 02:45:35.049128
[0m02:45:35.050128 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m02:45:35.050128 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.bad_practice_customers_core (compile): 02:45:35.032127 => 02:45:35.050128
[0m02:45:35.051129 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m02:45:35.081128 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m02:45:35.082165 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.bad_practice_customers_core
[0m02:45:35.085127 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m02:45:35.104131 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.bad_practice_customers_core"
[0m02:45:35.105128 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m02:45:35.107132 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m02:45:35.108126 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m02:45:35.109126 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.bad_practice_customers_core"
[0m02:45:35.109126 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m02:45:35.110126 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:45:35.111125 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: BEGIN
[0m02:45:35.112126 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:45:35.114668 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:45:35.149553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:45:35.150602 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.bad_practice_customers_core"
[0m02:45:35.151614 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.bad_practice_customers_core"} */

  create view "jaffle_shop"."dw"."bad_practice_customers_core__dbt_tmp"
    
    
  as (
    


with customers_core as (

    select
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers

),

orders_core as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders

),


customer_orders_core as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders_core

    group by 1

),

final as (

    select
        cc.customer_id,
        cc.first_name,
        cc.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.number_of_orders, 0) as number_of_orders
    from customers_core as cc

    left join customer_orders_core as co using (customer_id) 

)

select * from final
  );
[0m02:45:35.162561 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:45:35.163128 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:45:35.163664 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m02:45:35.165269 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m02:45:35.166327 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
    

  create  table "jaffle_shop"."dw"."stg_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from jaffle_shop.customers
)

select * from customers
  );
  
[0m02:45:35.167383 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
    

  create  table "jaffle_shop"."dw"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from jaffle_shop.orders
)

select * from orders
  );
  
[0m02:45:35.188315 [debug] [Thread-2 (]: SQL status: SELECT 100 in 0.0 seconds
[0m02:45:35.194748 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m02:45:35.195278 [debug] [Thread-3 (]: SQL status: SELECT 99 in 0.0 seconds
[0m02:45:35.195814 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:45:35.196343 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m02:45:35.199548 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m02:45:35.202255 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.bad_practice_customers_core"
[0m02:45:35.204379 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m02:45:35.205455 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.205985 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.bad_practice_customers_core"} */
alter table "jaffle_shop"."dw"."bad_practice_customers_core__dbt_tmp" rename to "bad_practice_customers_core"
[0m02:45:35.210938 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m02:45:35.211471 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.212556 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "jaffle_shop"."dw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m02:45:35.213610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.216776 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m02:45:35.235824 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: COMMIT
[0m02:45:35.235824 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.236820 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "jaffle_shop"."dw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m02:45:35.238819 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.bad_practice_customers_core"
[0m02:45:35.245824 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m02:45:35.248423 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: COMMIT
[0m02:45:35.250350 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m02:45:35.250927 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.253093 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m02:45:35.255715 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m02:45:35.257823 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.258888 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m02:45:35.266294 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.bad_practice_customers_core"
[0m02:45:35.266799 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.267889 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m02:45:35.268395 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.bad_practice_customers_core"} */
drop view if exists "jaffle_shop"."dw"."bad_practice_customers_core__dbt_backup" cascade
[0m02:45:35.271403 [debug] [Thread-2 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m02:45:35.273922 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."dw"."stg_customers__dbt_backup" cascade
[0m02:45:35.274303 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:45:35.276986 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.bad_practice_customers_core (execute): 02:45:35.087125 => 02:45:35.276986
[0m02:45:35.277513 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.278563 [debug] [Thread-1 (]: On model.jaffle_shop.bad_practice_customers_core: Close
[0m02:45:35.281217 [debug] [Thread-3 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m02:45:35.283373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1053C2D0>]}
[0m02:45:35.284457 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."dw"."stg_orders__dbt_backup" cascade
[0m02:45:35.286142 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dw.bad_practice_customers_core ................ [[32mCREATE VIEW[0m in 0.26s]
[0m02:45:35.288298 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.bad_practice_customers_core
[0m02:45:35.292515 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:45:35.294621 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_customers (execute): 02:45:35.083128 => 02:45:35.294621
[0m02:45:35.295674 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: Close
[0m02:45:35.296726 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:45:35.297821 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10DF1190>]}
[0m02:45:35.299409 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_orders (execute): 02:45:35.052126 => 02:45:35.299409
[0m02:45:35.301008 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dw.stg_customers ............................. [[32mSELECT 100[0m in 0.27s]
[0m02:45:35.302072 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: Close
[0m02:45:35.303126 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m02:45:35.304705 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10EE3490>]}
[0m02:45:35.307327 [info ] [Thread-3 (]: 3 of 4 OK created sql table model dw.stg_orders ................................ [[32mSELECT 99[0m in 0.28s]
[0m02:45:35.309335 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m02:45:35.310335 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m02:45:35.311335 [info ] [Thread-4 (]: 4 of 4 START sql table model dw.dim_customers .................................. [RUN]
[0m02:45:35.314378 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.jaffle_shop.dim_customers'
[0m02:45:35.315447 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m02:45:35.318750 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m02:45:35.320943 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (compile): 02:45:35.316549 => 02:45:35.320943
[0m02:45:35.322021 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m02:45:35.325654 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m02:45:35.327668 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m02:45:35.328667 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m02:45:35.329654 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:45:35.371620 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:45:35.372676 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m02:45:35.373724 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "jaffle_shop"."dw"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

    select * from "jaffle_shop"."dw"."stg_customers"

),

orders as (

    select * from "jaffle_shop"."dw"."stg_orders"

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m02:45:35.390581 [debug] [Thread-4 (]: SQL status: SELECT 100 in 0.0 seconds
[0m02:45:35.394096 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m02:45:35.395095 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."dw"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m02:45:35.400672 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.403182 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m02:45:35.403182 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m02:45:35.404182 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m02:45:35.410860 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.413736 [debug] [Thread-4 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m02:45:35.414380 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."dw"."dim_customers__dbt_backup" cascade
[0m02:45:35.417235 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:35.418998 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.dim_customers (execute): 02:45:35.322591 => 02:45:35.418393
[0m02:45:35.419547 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m02:45:35.420715 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50ddb150-3871-46ce-a0e5-3e7b0e28af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC10F17BD0>]}
[0m02:45:35.422470 [info ] [Thread-4 (]: 4 of 4 OK created sql table model dw.dim_customers ............................. [[32mSELECT 100[0m in 0.11s]
[0m02:45:35.424132 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m02:45:35.426334 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:35.426898 [debug] [MainThread]: On master: BEGIN
[0m02:45:35.427927 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:45:35.479417 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:45:35.480511 [debug] [MainThread]: On master: COMMIT
[0m02:45:35.481592 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:35.482148 [debug] [MainThread]: On master: COMMIT
[0m02:45:35.484319 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.485399 [debug] [MainThread]: On master: Close
[0m02:45:35.486514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:45:35.487067 [debug] [MainThread]: Connection 'list_jaffle_shop' was properly closed.
[0m02:45:35.488155 [debug] [MainThread]: Connection 'list_jaffle_shop_dw' was properly closed.
[0m02:45:35.489219 [debug] [MainThread]: Connection 'model.jaffle_shop.bad_practice_customers_core' was properly closed.
[0m02:45:35.489756 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m02:45:35.490832 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m02:45:35.491356 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m02:45:35.492421 [info ] [MainThread]: 
[0m02:45:35.493013 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m02:45:35.494598 [debug] [MainThread]: Command end result
[0m02:45:35.501653 [info ] [MainThread]: 
[0m02:45:35.503653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:45:35.505653 [info ] [MainThread]: 
[0m02:45:35.507656 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:45:35.509654 [debug] [MainThread]: Command `dbt run` succeeded at 02:45:35.509654 after 1.31 seconds
[0m02:45:35.510654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC0A9DE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC0A9E5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC0A9E5350>]}
[0m02:45:35.511655 [debug] [MainThread]: Flushing usage events
